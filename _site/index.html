<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Where DFIR Meets IT - ForensicITGuy's blog about DFIR and tech</title>
    <meta name="description" content="ForensicITGuy's blog about DFIR and tech" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css " />

</head>
<body class="home-template">

    <header class="main-header no-cover">
    <nav class="main-nav overlay clearfix">
            
        <a class="subscribe-button icon-feed" href="/feed.xml ">Subscribe</a>
    </nav>
    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title">Where DFIR Meets IT</h1>
            <h2 class="page-description">
                 ForensicITGuy's blog about DFIR and tech. 
                 <a href='/about.html'> About me </a> 
            </h2>
        </div>
    </div>
    <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
</header>


<main id="content" class="content" role="main">


    <div class="extra-pagination inner">
        <nav class="pagination" role="pagination">
    
    <span class="page-number"> Page 1 of 1 </span>
     
</nav>
    </div>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/windows/7zip/sfx/self-extracting/installers/2021/07/10/extracting-sfx-installer.html">Extracting Malicious Payloads from SFX Self-Extracting Installers</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Self-extracting installers are an awesome way to distribute software because they require very little overhead and minimal configuration. Because of this, some malware threats use these SFX files to deploy components to victim systems, and malware analysts need to know how to safely unpack the components for investigation. For this example, we’re going to walk through the process to unpack this malicious installer: <a href="https://www.virustotal.com/gui/file/9d27976b21da5fc419da598ea44456a528b9fbf83f24fc5e14f697f610a5b295/detection">https://www.virustotal.com/gui/file/9d27976b21da5fc419da598ea44456a528b9fbf83f24fc5e14f697f610a5b295/detection</a>.</p>
 <a class="read-more" href="/windows/7zip/sfx/self-extracting/installers/2021/07/10/extracting-sfx-installer.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on windows, 7zip, sfx, self-extracting, and installers 
            
            <time class="post-date" datetime="2021-07-10">
                10 Jul 2021
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/macos/empire/pkg/malware/2021/02/08/analyzing-empire-macos-pkg.html">Analyzing an Empire macOS PKG Stager</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Command and control (C2) frameworks often support multiple platforms, and PowerShell Empire is no different. In older days, there was a Python Empyre version that eventually merged into the full Empire project and support for macOS and Linux systems still exists within Empire. For these platforms, Empire leverages python-based launchers to execute commands. While the Python launchers may be platform independent, adversaries must still deliver them to victim hosts. This delivery presents an excellent opportunity for detection and analysis. For this example, we’re going to walk through the analysis of an Empire stager found in VirusTotal: <a href="https://www.virustotal.com/gui/file/19e19adc03b313236462b30a1a438a604d4c0b4c86268b951689696144a63fdc/detection">https://www.virustotal.com/gui/file/19e19adc03b313236462b30a1a438a604d4c0b4c86268b951689696144a63fdc/detection</a>.</p>
 <a class="read-more" href="/macos/empire/pkg/malware/2021/02/08/analyzing-empire-macos-pkg.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on macOS, Empire, PKG, and malware 
            
            <time class="post-date" datetime="2021-02-08">
                08 Feb 2021
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/qbot/malware/esentutil/2021/02/01/how-qbot-uses-esentutl.html">How Qbot Uses Esentutl</a></h2>
        </header>
        <section class="post-excerpt">
            <p>A colleague asked me a question today about the relationship between Qbot and a Windows system utility: <code class="language-plaintext highlighter-rouge">esentutl.exe</code>. It’s been sparsely documented <a href="https://twitter.com/redcanary/status/1334224870536712192">via tweet</a>, and I want to more fully explain why Qbot jumped into using the utility during operations.</p>
 <a class="read-more" href="/qbot/malware/esentutil/2021/02/01/how-qbot-uses-esentutl.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on qbot, malware, and esentutil 
            
            <time class="post-date" datetime="2021-02-01">
                01 Feb 2021
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/redhat/rhcsa/linux/certification/redirection/input/output/piping/python/base64/bash/2020/02/29/road-to-rhcsa8-input-redirection.html">Road to RHCSA 8 - I/O Redirection, Piping, and Their Evil Uses</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Bourne-compatible Unix shells (<code class="language-plaintext highlighter-rouge">bash</code>, <code class="language-plaintext highlighter-rouge">sh</code>, etc.) usually include capabilities to redirect input and output in the shell. One of the basic objectives of RHCSA 8 is to learn how to manipulate input and output, and since I work in security I wanted to put a spin on the content to show how adversaries may use I/O redirection to stump defenders. If you already know about I/O redirection and you’re just here for the security stuff, <a href="#-Evil-Uses-of-Redirection-and-Piping">jump forward here</a>.</p>
 <a class="read-more" href="/redhat/rhcsa/linux/certification/redirection/input/output/piping/python/base64/bash/2020/02/29/road-to-rhcsa8-input-redirection.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on RedHat, RHCSA, Linux, certification, redirection, input, output, piping, python, base64, and bash 
            
            <time class="post-date" datetime="2020-02-29">
                29 Feb 2020
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/ld_preload/linux/edr/evasion/meterpreter/2020/02/06/linux-edr-evasion-with-ld-preload.html">Linux EDR Evasion With Meterpreter and LD_PRELOAD</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Everyone has their favorite adversary technique to research and mine is LD_PRELOAD process injection because it’s pretty versatile. It lets you hook functions to manipulate output, and it can also let you trip up defenders by injecting code into arbitrary processes for execution. In this post, I’ll walk through how an adversary might combine Meterpreter with LD_PRELOAD to hide malicious activity under a legitimate Linux system process.</p>
 <a class="read-more" href="/ld_preload/linux/edr/evasion/meterpreter/2020/02/06/linux-edr-evasion-with-ld-preload.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on ld_preload, linux, edr, evasion, and meterpreter 
            
            <time class="post-date" datetime="2020-02-06">
                06 Feb 2020
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/dnf/yum/linux/plugin/persistence/2020/01/13/exploiting-yum-dnf-plugins.html">Exploiting Yum and DNF Plugins for Persistence</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Two Metasploit Framework modules have held my interest in the last few weeks: the ones for persistence using Linux package managers <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/apt_package_manager_persistence.rb">apt</a> and <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/yum_package_manager_persistence.rb">Yum</a>. While they require root privileges to exploit, they provide a novel persistence mechanism that is likely overlooked by defenders. While looking at these modules I noticed that persistence using DNF wasn’t included, and I set off to find a way to persist on Linux systems using DNF plugins.</p>
 <a class="read-more" href="/dnf/yum/linux/plugin/persistence/2020/01/13/exploiting-yum-dnf-plugins.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on DNF, Yum, Linux, Plugin, and Persistence 
            
            <time class="post-date" datetime="2020-01-13">
                13 Jan 2020
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/windows/active-directory/domain-controllers/accounts/administrators/2020/01/09/when-local-resets-arent-local.html">When Local Password Resets Aren't Local</a></h2>
        </header>
        <section class="post-excerpt">
            <h2 id="when-you-reset-a-domain-administrator-instead-of-local">When You Reset a Domain Administrator Instead of Local</h2>
 <a class="read-more" href="/windows/active-directory/domain-controllers/accounts/administrators/2020/01/09/when-local-resets-arent-local.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on windows, active-directory, domain-controllers, accounts, and administrators 
            
            <time class="post-date" datetime="2020-01-09">
                09 Jan 2020
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/redhat/rhcsa/linux/certification/education/2020/01/02/road-to-rhcsa8-00.html">Road to RHCSA 8 - Getting Started</a></h2>
        </header>
        <section class="post-excerpt">
            <p><em>Updated 2020-01-04</em> - Added the Red Hat Certs Slack group to the community list and lab environment to the lab list.</p>
 <a class="read-more" href="/redhat/rhcsa/linux/certification/education/2020/01/02/road-to-rhcsa8-00.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on RedHat, RHCSA, Linux, certification, and education 
            
            <time class="post-date" datetime="2020-01-02">
                02 Jan 2020
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/ld_preload/linux/whitelisting/unix/ld_audit/libpreloadvaccine/2019/08/29/whitelisting-ld_preload-for-fun-and-no-profit.html">Whitelisting LD_PRELOAD for Fun and No Profit</a></h2>
        </header>
        <section class="post-excerpt">
            <p>If you’ve been around the Linux/BSD/Solaris/Other UNIX ecosystem for a while you’ve probably heard of the fabled LD_PRELOAD trick. If you haven’t heard of it, let me introduce you to one of the longest-held, dirty security issues in UNIX…</p>
 <a class="read-more" href="/ld_preload/linux/whitelisting/unix/ld_audit/libpreloadvaccine/2019/08/29/whitelisting-ld_preload-for-fun-and-no-profit.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on ld_preload, linux, whitelisting, unix, ld_audit, and libpreloadvaccine 
            
            <time class="post-date" datetime="2019-08-29">
                29 Aug 2019
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/merlin/ld_preload/red_team/2019/08/28/adding-process-hiding-to-merlin.html">Adding Process Hiding to Merlin</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Sometimes red team tools need a little bit of extra love to address certain platforms. As I researched Merlin for detection strategies on the blue team side, I noticed that it could use some extra functionality to help replicate what we see in the real world for Linux compromises.</p>
 <a class="read-more" href="/merlin/ld_preload/red_team/2019/08/28/adding-process-hiding-to-merlin.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on merlin, ld_preload, and red_team 
            
            <time class="post-date" datetime="2019-08-28">
                28 Aug 2019
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/meterpreter/chrome/msfvenom/jar/metasploit/2019/01/18/making-meterpreter-look-google-signed.html">Making Meterpreter Look Google Signed</a></h2>
        </header>
        <section class="post-excerpt">
            <p>In this post I’ll use some of the information made public by VirusTotal in a <a href="https://blog.virustotal.com/2019/01/distribution-of-malicious-jar-appended.html">recent blog post</a> and show how you can easily create a Metasploit Meterpreter payload and append it to a signed MSI file. This will allow you to leverage the code signing from the MSI file to make your payload appear legitimately signed by Google, Inc. After I’ll cover a bit of discussion on why this technique is dangerously significant and how to investigate for its use.
We need a few prerequisites to start-</p>
 <a class="read-more" href="/meterpreter/chrome/msfvenom/jar/metasploit/2019/01/18/making-meterpreter-look-google-signed.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on meterpreter, chrome, msfvenom, jar, and metasploit 
            
            <time class="post-date" datetime="2019-01-18">
                18 Jan 2019
            </time> 
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/sans/dfir/netwars/2018/08/26/my-sans-dfir-netwars-experience.html">My SANS DFIR NetWars Experience</a></h2>
        </header>
        <section class="post-excerpt">
            <p>At SANSFIRE 2018 in Washington, DC I had the awesome opportunity to compete in SANS DFIR NetWars with a coworker from Red Canary. This was my first experience with NetWars, and I wasn’t sure what to expect with the tournament. We heard that at SANSFIRE DFIR NetWars would allow team competition this time around, which is different from the previous individual-only competition. I went to a SANS@Night session titled “Intro to NetWars” given by Tim Medin of Red Siege Infosec fame with my coworker and our experience soon turned into a recruiting effort. We realized that we could perform Windows disk and memory forensics fairly well alongside network forensics, but neither of us could work well with smartphone, Apple forensics, or malware analysis beyond running simple static analysis tools. That said, we met a couple of awesome folks willing to team up with us for the tournament at the session.</p>
 <a class="read-more" href="/sans/dfir/netwars/2018/08/26/my-sans-dfir-netwars-experience.html">&raquo;</a>
        </section>
        <footer class="post-meta">
            
                <img class="author-thumb" src="/assets/images/profile.png" alt="Author's profile picture" nopin="nopin" />
                Tony Lambert (ForensicITGuy)
            
             
                on SANS, DFIR, and NetWars 
            
            <time class="post-date" datetime="2018-08-26">
                26 Aug 2018
            </time> 
        </footer>
    </article>

    

    <nav class="pagination" role="pagination">
    
    <span class="page-number"> Page 1 of 1 </span>
     
</nav>

</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="">Where DFIR Meets IT</a> &copy; 
              2021 &bull; All rights reserved.
      </section>
      <section class="poweredby">Made with Jekyll using 
        <a href="http://github.com/rosario/kasper">Kasper theme</a>
      </section>
    </footer>
    
    <script type="text/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-155060013-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>   
</body>
</html>
