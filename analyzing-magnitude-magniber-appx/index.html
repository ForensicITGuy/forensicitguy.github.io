<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Analyzing a Magnitude EK Appx Package Dropping Magniber" /><meta property="og:locale" content="en" /><meta name="description" content="In this post I’ll work through analyzing an AppX package from Magnitude Exploit Kit that drops Magniber. This adventure comes courtesy of a tweet from @JAMESWT_MHT:" /><meta property="og:description" content="In this post I’ll work through analyzing an AppX package from Magnitude Exploit Kit that drops Magniber. This adventure comes courtesy of a tweet from @JAMESWT_MHT:" /><link rel="canonical" href="https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/" /><meta property="og:url" content="https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/" /><meta property="og:site_name" content="Tony Lambert" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-02T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Analyzing a Magnitude EK Appx Package Dropping Magniber" /><meta name="twitter:site" content="@ForensicITGuy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-28T23:09:20+00:00","datePublished":"2022-01-02T00:00:00+00:00","description":"In this post I’ll work through analyzing an AppX package from Magnitude Exploit Kit that drops Magniber. This adventure comes courtesy of a tweet from @JAMESWT_MHT:","headline":"Analyzing a Magnitude EK Appx Package Dropping Magniber","mainEntityOfPage":{"@type":"WebPage","@id":"https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/"},"url":"https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/"}</script><title>Analyzing a Magnitude EK Appx Package Dropping Magniber | Tony Lambert</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tony Lambert"><meta name="application-name" content="Tony Lambert"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Tony Lambert</a></div><div class="site-subtitle font-italic">An educator that does security things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ForensicITGuy" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ForensicITGuy" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://ko-fi.com/forensicitguy" aria-label="ko-fi" target="_blank" rel="noopener"> <i class="fas fa-mug-hot"></i> </a> <a href="https://infosec.exchange/web/@ForensicITGuy" aria-label="mastodon" target="_blank" rel="noopener"> <i class="fab fa-mastodon"></i> </a> <a href="https://www.linkedin.com/in/tonymlambert/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Analyzing a Magnitude EK Appx Package Dropping Magniber</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Analyzing a Magnitude EK Appx Package Dropping Magniber</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1641081600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-01-02 </em> </span> <span> Updated <em class="timeago" data-ts="1648508960" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-28 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1850 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p>In this post I’ll work through analyzing an AppX package from Magnitude Exploit Kit that drops Magniber. This adventure comes courtesy of a tweet from @JAMESWT_MHT:</p><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Some <a href="https://twitter.com/hashtag/Magniber?src=hash&amp;ref_src=twsrc%5Etfw">#Magniber</a> samples<a href="https://t.co/6XaMq0X2QH">https://t.co/6XaMq0X2QH</a> <a href="https://t.co/wWef0eSk2o">https://t.co/wWef0eSk2o</a></p>&mdash; JAMESWT (@JAMESWT_MHT) <a href="https://twitter.com/JAMESWT_MHT/status/1477259577372651521?ref_src=twsrc%5Etfw">January 1, 2022</a></blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>This caught my interest because AppX packages have gotten some mileage as droppers lately courtesy of Bazar and Emotet.</p><ul><li><a href="https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/">https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/</a><li><a href="https://redcanary.com/blog/intelligence-insights-december-2021/">https://redcanary.com/blog/intelligence-insights-december-2021/</a></ul><p>If you want to play along from home, the file I’m analyzing is here: <a href="https://bazaar.abuse.ch/sample/da1729efaaa590d66f46d388680ed5b1b956246ababd277e7cdd14f90fbf60fa/">https://bazaar.abuse.ch/sample/da1729efaaa590d66f46d388680ed5b1b956246ababd277e7cdd14f90fbf60fa/</a></p><h2 id="analyzing-the-appx-package"><span class="mr-2">Analyzing the AppX Package</span><a href="#analyzing-the-appx-package" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To start off, let’s get a handle on what kind of file an AppX package is. We can do this using <code class="language-plaintext highlighter-rouge">file</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/magnitude/update$ file edge_update.appx 
edge_update.appx: Zip archive data, at least v4.5 to extract
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">file</code> command says the magic bytes for the file correspond to a zip archive. This is common with application or package archives like AppX, JARs, and more. If we want more confirmation we can always look at the first few bytes with <code class="language-plaintext highlighter-rouge">hexdump</code> and <code class="language-plaintext highlighter-rouge">head</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/magnitude/update$ hexdump -C edge_update.appx | head
00000000  50 4b 03 04 2d 00 08 00  00 00 f8 6e 9d 53 00 00  |PK..-......n.S..|
00000010  00 00 00 00 00 00 00 00  00 00 26 00 00 00 49 6d  |..........&amp;...Im|
00000020  61 67 65 73 2f 53 71 75  61 72 65 31 35 30 78 31  |ages/Square150x1|
00000030  35 30 4c 6f 67 6f 2e 73  63 61 6c 65 2d 31 35 30  |50Logo.scale-150|
00000040  2e 70 6e 67 89 50 4e 47  0d 0a 1a 0a 00 00 00 0d  |.png.PNG........|
00000050  49 48 44 52 00 00 00 e1  00 00 00 e1 08 06 00 00  |IHDR............|
00000060  00 3e b3 d2 7a 00 00 00  09 70 48 59 73 00 00 0e  |.&gt;..z....pHYs...|
00000070  c3 00 00 0e c3 01 c7 6f  a8 64 00 00 71 fc 49 44  |.......o.d..q.ID|
00000080  41 54 78 9c ec bd 77 90  25 c7 79 27 f8 65 99 e7  |ATx...w.%.y'.e..|
00000090  db 9b e9 ee f1 33 98 19  0c 06 84 77 04 41 18 92  |.....3.....w.A..|
</pre></table></code></div></div><p>Yup, looks like a zip file based on <a href="https://www.garykessler.net/library/file_sigs.html"><code class="language-plaintext highlighter-rouge">50 4b 03 04</code></a>! That means we can unpack the archive using <code class="language-plaintext highlighter-rouge">unzip</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/magnitude/update$ unzip edge_update.appx
Archive:  edge_update.appx
 extracting: Images/Square150x150Logo.scale-150.png  
 extracting: Images/Wide310x150Logo.scale-150.png  
 extracting: Images/SmallTile.scale-150.png  
 extracting: Images/LargeTile.scale-150.png  
 extracting: Images/BadgeLogo.scale-150.png  
 extracting: Images/SplashScreen.scale-150.png  
 extracting: Images/StoreLogo.scale-150.png  
 extracting: Images/Square44x44Logo.targetsize-32.png  
 extracting: Images/Square44x44Logo.altform-unplated_targetsize-32.png  
 extracting: Images/Square44x44Logo.scale-150.png  
 extracting: Images/Square44x44Logo.altform-lightunplated_targetsize-32.png  
  inflating: eediwjus/eediwjus.exe   
  inflating: eediwjus/eediwjus.dll   
  inflating: resources.pri           
  inflating: AppxManifest.xml        
  inflating: AppxBlockMap.xml        
  inflating: [Content_Types].xml     
  inflating: AppxMetadata/CodeIntegrity.cat  
  inflating: AppxSignature.p7x
</pre></table></code></div></div><p>With the archive unzipped, we can focus on significant files within the package. These are:</p><ul><li>AppxManifest.xml (<a href="https://www.advancedinstaller.com/hub/msix-packaging/appxmanifest.html">list of properties and components</a> used by the AppX package)<li>AppxSignature.p7x (<a href="https://github.com/microsoft/msix-packaging/blob/master/src/inc/internal/AppxSignature.hpp">AppX Signature Object</a>, contains code signatures for AppX Package)<li>eediwjus/eediwjus.exe (non-default content that is likely executable)<li>eediwjus/eediwjus.dll (non-default content that is likely executable)</ul><p>First, we can look at the AppxManifest.xml file. I’ve included the points of interest below.</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;Package</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/appx/manifest/foundation/windows10"</span> <span class="na">xmlns:uap=</span><span class="s">"http://schemas.microsoft.com/appx/manifest/uap/windows10"</span> <span class="err">xmlns:re</span>
<span class="na">scap=</span><span class="s">"http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities"</span> <span class="na">IgnorableNamespaces=</span><span class="s">"uap rescap build"</span> <span class="na">xmlns:build=</span><span class="s">"http://schem
as.microsoft.com/developer/appx/2015/build"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Identity</span> <span class="na">Name=</span><span class="s">"3669e262-ec02-4e9d-bcb4-3d008b4afac9"</span> <span class="na">Publisher=</span><span class="s">"CN=Foresee Consulting Inc., O=Foresee Consulting Inc., L=North York, S=Ontario, C=CA, SERIA
LNUMBER=1004913-1, OID.1.3.6.1.4.1.311.60.2.1.3=CA, OID.2.5.4.15=Private Organization"</span> <span class="na">Version=</span><span class="s">"96.0.1072.0"</span> <span class="na">ProcessorArchitecture=</span><span class="s">"neutral"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Properties&gt;</span>
    <span class="nt">&lt;DisplayName&gt;</span>Edge Update<span class="nt">&lt;/DisplayName&gt;</span>
    <span class="nt">&lt;PublisherDisplayName&gt;</span>Microsoft Inc<span class="nt">&lt;/PublisherDisplayName&gt;</span>
    <span class="nt">&lt;Logo&gt;</span>Images\StoreLogo.png<span class="nt">&lt;/Logo&gt;</span>
  <span class="nt">&lt;/Properties&gt;</span>

...

  <span class="nt">&lt;Applications&gt;</span>
    <span class="nt">&lt;Application</span> <span class="na">Id=</span><span class="s">"App"</span> <span class="na">Executable=</span><span class="s">"eediwjus\eediwjus.exe"</span> <span class="na">EntryPoint=</span><span class="s">"Windows.FullTrustApplication"</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/Application&gt;</span>
  <span class="nt">&lt;/Applications&gt;</span>
  <span class="nt">&lt;Capabilities&gt;</span>
    <span class="nt">&lt;Capability</span> <span class="na">Name=</span><span class="s">"internetClient"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;rescap:Capability</span> <span class="na">Name=</span><span class="s">"runFullTrust"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/Capabilities&gt;</span>
<span class="nt">&lt;/Package&gt;</span>
</pre></table></code></div></div><p>First, let’s take a look at the Identity and Properties sections. Identity contains code signature information that should theoretically be included within the AppxSignature.p7x file. The Properties section contains metadata the Windows Store/Universal Windows App interface uses to identify the app. From the name <code class="language-plaintext highlighter-rouge">Edge Update</code> and publisher name <code class="language-plaintext highlighter-rouge">Microsoft Inc</code>, it appears the malware wants to masquerade as a Microsoft Edge browser update. Note how there is no link or control between the publisher display name and the actual signing identity. This is a major problem for victims trying to be sure of themselves.</p><p>The Application section identifies the EXE that will execute when the package is installed and run. In this sample, the EXE is <code class="language-plaintext highlighter-rouge">eediwjus.exe</code>. In the package content there is also a DLL, but that isn’t mentioned in the manifest. A possibility to explore might be that the EXE uses content from the DLL for execution.</p><p>Finally, the Capabilities section shows the app will execute with <code class="language-plaintext highlighter-rouge">internetClient</code> and <code class="language-plaintext highlighter-rouge">runFullTrust</code> capabilities. <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations">Documented by Microsoft</a>, these capabilities just mean the app can download stuff from the Internet. Now we can jump into the executable content, the EXE file.</p><h2 id="analyzing-the-application-executable"><span class="mr-2">Analyzing the Application Executable</span><a href="#analyzing-the-application-executable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The EXE has these hashes:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>filepath:                        eediwjus.exe
md5:                             3439bbe95df314d390cc4862cdad94fd
sha1:                            92429885d54a05ed87a5c14d34aa504c28ea8b54
sha256:                          ad4f74c0c3ac37e6f1cf600a96ae203c38341d263dbac0741e602686794c4f5a
ssdeep:                          48:6/yaz1YKkikwFJSDq6tPRqBHwOul2a3iq:yz1fkigtJkGYK
imphash:                         f34d5f2d4577ed6d9ceec516c1f5a744
</pre></table></code></div></div><p>Note the import table hash starting with <code class="language-plaintext highlighter-rouge">f34d</code>. That specific import table hash commonly appears with .NET binaries, so if you pivot on it in VT or other tools, you’ll find a lot of .NET. Using <code class="language-plaintext highlighter-rouge">Detect It Easy</code> in REMnux, we can confirm the executable is a .NET binary.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/magnitude/update/eediwjus$ diec eediwjus.exe 
filetype: PE32
arch: I386
mode: 32-bit
endianess: LE
type: GUI
  library: .NET(v4.0.30319)[-]
  linker: Microsoft Linker(11.0)[GUI32]
</pre></table></code></div></div><p>So let’s take a peek with <code class="language-plaintext highlighter-rouge">floss</code> from Mandiant to see if there are signs of obfuscation. There aren’t any signs of obfuscation like randomized, high-entropy strings, but we do get some interesting strings.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>mscorlib
System
Object
mhjpfzvitta
Main
.ctor
lpBuffer
args
System.Runtime.Versioning
TargetFrameworkAttribute
System.Security.Permissions
SecurityPermissionAttribute
SecurityAction
System.Runtime.CompilerServices
CompilationRelaxationsAttribute
RuntimeCompatibilityAttribute
System.Runtime.InteropServices
DllImportAttribute
eediwjus.dll
</pre></table></code></div></div><p>Sure enough, the EXE references the DLL in the same folder, and it includes the string <code class="language-plaintext highlighter-rouge">DllImportAttribute</code>. This is a good sign that the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.dllimportattribute?view=net-6.0">EXE will load an unmanaged DLL and call an export</a> from it. Unobfuscated .NET code is usually pretty easy to decompile from bytecode form into source, so we can give that a shot with <code class="language-plaintext highlighter-rouge">ilspycmd</code>. If you’re on Windows you can also use <code class="language-plaintext highlighter-rouge">ILSpy</code> or <code class="language-plaintext highlighter-rouge">DNSpy</code>. The result is a pretty brief source file:</p><div class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.Reflection</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.CompilerServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.InteropServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Runtime.Versioning</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Permissions</span><span class="p">;</span>

<span class="p">[</span><span class="n">assembly</span><span class="p">:</span> <span class="nf">TargetFramework</span><span class="p">(</span><span class="s">".NETFramework,Version=v4.5"</span><span class="p">,</span> <span class="n">FrameworkDisplayName</span> <span class="p">=</span> <span class="s">".NET Framework 4.5"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span> <span class="nf">CompilationRelaxations</span><span class="p">(</span><span class="m">8</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span> <span class="nf">RuntimeCompatibility</span><span class="p">(</span><span class="n">WrapNonExceptionThrows</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span> <span class="nf">SecurityPermission</span><span class="p">(</span><span class="m">8</span><span class="p">,</span> <span class="n">SkipVerification</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span> <span class="nf">AssemblyVersion</span><span class="p">(</span><span class="s">"0.0.0.0"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">module</span><span class="p">:</span> <span class="n">UnverifiableCode</span><span class="p">]</span>
<span class="k">namespace</span> <span class="nn">eediwjus</span>
<span class="p">{</span>
	<span class="k">public</span> <span class="k">class</span> <span class="nc">eediwjus</span>
	<span class="p">{</span>
		<span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"eediwjus.dll"</span><span class="p">)]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="k">void</span> <span class="nf">mhjpfzvitta</span><span class="p">(</span><span class="kt">uint</span> <span class="n">lpBuffer</span><span class="p">);</span>

		<span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">uint</span> <span class="n">lpBuffer</span> <span class="p">=</span> <span class="m">5604u</span><span class="p">;</span>
			<span class="nf">mhjpfzvitta</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The entry point for the program is the <code class="language-plaintext highlighter-rouge">Main</code> function inside the <code class="language-plaintext highlighter-rouge">eediwjus</code> class. The <code class="language-plaintext highlighter-rouge">DllImport</code> code imports the function <code class="language-plaintext highlighter-rouge">mhjpfzvitta()</code> from the DLL and calls it with the argument <code class="language-plaintext highlighter-rouge">lpBuffer</code>. That argument contains an unsigned integer value of 5604. <code class="language-plaintext highlighter-rouge">lpBuffer</code> appears loads of times in Microsoft documentation around Windows calls like <code class="language-plaintext highlighter-rouge">VirtualAlloc</code> and others that need a buffer of memory for operation. It stands to reason that <code class="language-plaintext highlighter-rouge">lpBuffer</code> here might correspond to some form of a memory management call.</p><h2 id="analyzing-the-magniber-dll"><span class="mr-2">Analyzing the Magniber DLL</span><a href="#analyzing-the-magniber-dll" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The DLL has these hashes:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>filepath:                        eediwjus.dll
md5:                             e7e4878847d31c4de301d3edf7378ecb
sha1:                            a93d0f59b3374c6d3669a5872d44515f056e9dbf
sha256:                          f423bd6daae6c8002acf5c203267e015f7beb4c52ed54a78789dd86ab35e46c6
ssdeep:                          96:qUG6xykl2J6lc5irN3qjNu47Ru/8IAgecgKDD:qsQMl0u3qjA47RuZAhk
</pre></table></code></div></div><p>Our <code class="language-plaintext highlighter-rouge">pehash</code> command didn’t find an import table hash, so that’s interesting. There may not be an import table in this binary or it might be mangled. We can take a look using the Python <code class="language-plaintext highlighter-rouge">pefile</code> library.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/magnitude/update/eediwjus$ python3
Python 3.8.10 (default, Nov 26 2021, 20:14:08) 
[GCC 9.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import pefile
&gt;&gt;&gt; bin = pefile.PE('eediwjus.dll')
&gt;&gt;&gt; bin.get_imphash()
''
&gt;&gt;&gt; bin.get_rich_header_hash()
''
</pre></table></code></div></div><p>Sure enough, the binary doesn’t seem to have an import table hash or rich header hash. Maybe those parts don’t exist? We can confirm with <code class="language-plaintext highlighter-rouge">pefile</code> again.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>&gt;&gt;&gt; for directory in bin.OPTIONAL_HEADER.DATA_DIRECTORY:
...     print(directory)
... 
[IMAGE_DIRECTORY_ENTRY_EXPORT]
0x148      0x0   VirtualAddress:                0x2000    
0x14C      0x4   Size:                          0x4B      
[IMAGE_DIRECTORY_ENTRY_IMPORT]
0x150      0x0   VirtualAddress:                0x0       
0x154      0x4   Size:                          0x0  

...

&gt;&gt;&gt; bin.RICH_HEADER
&gt;&gt;&gt; 
</pre></table></code></div></div><p>Sure enough, the import table is apparently empty and no rich header exists for the binary. This is slightly unusual, so let’s see if we can run some more commands to find capabilities before jumping further into analysis.</p><p>The Mandiant tools <code class="language-plaintext highlighter-rouge">floss</code> and <code class="language-plaintext highlighter-rouge">capa</code> yield nothing significant.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>+-----------+------------------------------------------------------------------+
| md5       | e7e4878847d31c4de301d3edf7378ecb                                 |
| sha1      | a93d0f59b3374c6d3669a5872d44515f056e9dbf                         |
| sha256    | f423bd6daae6c8002acf5c203267e015f7beb4c52ed54a78789dd86ab35e46c6 |
| path      | eediwjus.dll                                                     |
+-----------+------------------------------------------------------------------+

no capabilities found
</pre></table></code></div></div><p>Yara tells us more of what we already know.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>remnux@remnux:~/cases/magnitude/update/eediwjus$ yara-rules eediwjus.dll 
IsPE64 eediwjus.dll
IsDLL eediwjus.dll
IsWindowsGUI eediwjus.dll
ImportTableIsBad eediwjus.dll
HasModified_DOS_Message eediwjus.dll
</pre></table></code></div></div><p>A <code class="language-plaintext highlighter-rouge">pedump</code> command gets us some export info. You could also get this with <code class="language-plaintext highlighter-rouge">pefile</code> in Python, I just like this output better.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>=== EXPORTS ===

# module "eediwjus.dll"
# flags=0x0  ts="2021-12-29 10:55:45"  version=0.0  ord_base=1
# nFuncs=1  nNames=1

  ORD ENTRY_VA  NAME
    1     1f74  mhjpfzvitta
</pre></table></code></div></div><p>The export <code class="language-plaintext highlighter-rouge">mhjpfzvitta()</code> jives with what we expect coming from the EXE previously seen. This is probably our best entry point to examine the DLL.</p><h2 id="getting-dirty-in-assembly"><span class="mr-2">Getting Dirty In Assembly</span><a href="#getting-dirty-in-assembly" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I usually work with Ghidra, but Cutter seemed to have a better representation of the assembly for this binary.</p><p>The entry point export <code class="language-plaintext highlighter-rouge">mhjpfzvitta()</code> is fairly brief.</p><pre><code class="language-assembly_x86">6: mhjpfzvitta (int64_t arg1);
; arg int64_t arg1 @ rcx
0x180001f74      call fcn.18000113f
0x180001f79      ret
</code></pre><p>The entry point immediately calls a function at offset <code class="language-plaintext highlighter-rouge">18000113f</code> and returns. Once we go to look at the assembly for that function, we see quite a wild execution graph.</p><p><img data-src="/assets/images/magnitude-magniber-appx-analysis/lots-of-jmps-1.png" alt="Lots of JMP instructions" data-proofer-ignore></p><p>Once entering the function, the sample contains loads of <code class="language-plaintext highlighter-rouge">jmp</code> instructions that cause execution to bounce around to various points of the binary. This makes it hard for analysts to follow execution, and eventually we see some more evidence of suspicious activity in decompiled code.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">undefined8</span> <span class="n">fcn</span><span class="p">.</span><span class="mi">180001</span><span class="n">f8e</span><span class="p">(</span><span class="kt">int64_t</span> <span class="n">arg1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">syscall</span><span class="p">();</span>
    <span class="k">return</span> <span class="mh">0x18</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Since the sample doesn’t have an import table, it’s relying on manual syscall calls like one to <code class="language-plaintext highlighter-rouge">0x18</code> for <code class="language-plaintext highlighter-rouge">NtAllocateVirtualMemory</code>. Avast saw this with Magniber <a href="https://decoded.avast.io/janvojtesek/magnitude-exploit-kit-still-alive-and-kicking/">in the past</a>, alongside the <code class="language-plaintext highlighter-rouge">jmp</code> obfuscation.</p><p><img data-src="/assets/images/magnitude-magniber-appx-analysis/0x40-0x1000-memory.png" alt="0x40 and 0x1000 values" data-proofer-ignore></p><p>While I’m not yet skilled enough to tear much more out of the binary through static analysis, my eye was caught by one section of code that pushes <code class="language-plaintext highlighter-rouge">0x40</code> and <code class="language-plaintext highlighter-rouge">0x1000</code> to registers. These two values sometimes pop up when malware calls <code class="language-plaintext highlighter-rouge">VirtualAlloc</code>. 0x40 refers to <code class="language-plaintext highlighter-rouge">PAGE_EXECUTE_READWRITE</code> protection and 0x1000 refers to <code class="language-plaintext highlighter-rouge">MEM_COMMIT</code>. Since these values popped up in the sample, we can hypothesize that the sample may inject or unpack material into a memory space.</p><h2 id="how-do-we-know-its-magniber"><span class="mr-2">How do we know it’s Magniber?</span><a href="#how-do-we-know-its-magniber" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I didn’t have luck getting Yara rules for Magniber to match this sample, so the best references I have right now are the tweet from @@JAMESWT_MHT and the blog post from Avast showing similar <code class="language-plaintext highlighter-rouge">jmp</code> obfuscation and syscall references.</p><p>Thanks for reading!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/malware/'>Malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/magnitude/" class="post-tag no-text-decoration" >magnitude</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/magniber/" class="post-tag no-text-decoration" >magniber</a> <a href="/tags/appx/" class="post-tag no-text-decoration" >appx</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Analyzing a Magnitude EK Appx Package Dropping Magniber - Tony Lambert&amp;url=https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Analyzing a Magnitude EK Appx Package Dropping Magniber - Tony Lambert&amp;u=https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/&amp;text=Analyzing a Magnitude EK Appx Package Dropping Magniber - Tony Lambert" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/pecheck-malware-weight-loss/">Bad Guys Hate This Trick for Malware Weight Loss!</a><li><a href="/formbook-via-vbs-powershell-and-csharp/">Formbook Distributed Via VBScript, PowerShell, and C# Code</a><li><a href="/agenttesla-vba-certutil-download/">An AgentTesla Sample Using VBA Macros and Certutil</a><li><a href="/my-sans-dfir-netwars-experience/">My SANS DFIR NetWars Experience</a><li><a href="/making-meterpreter-look-google-signed/">Making Meterpreter Look Google Signed</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/msi/">msi</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag" href="/tags/mshta/">mshta</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/cobalt-strike/">cobalt-strike</a> <a class="post-tag" href="/tags/csharp/">csharp</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/formbook-via-vbs-powershell-and-csharp/"><div class="card-body"> <em class="timeago small" data-ts="1648166400" > 2022-03-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Formbook Distributed Via VBScript, PowerShell, and C# Code</h3><div class="text-muted small"><p> Formbook is one of the threats that I categorize as part of the “background noise of exploitation” on the internet. While targeted attacks occur in scoped areas, anyone can go buy access for Formbo...</p></div></div></a></div><div class="card"> <a href="/agenttesla-vba-certutil-download/"><div class="card-body"> <em class="timeago small" data-ts="1648252800" > 2022-03-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>An AgentTesla Sample Using VBA Macros and Certutil</h3><div class="text-muted small"><p> AgentTesla is a .NET stealer that adversaries commonly buy and combine with other malicious products for deployment. In this post I’m tearing into a XLSM document that downloads and executes furthe...</p></div></div></a></div><div class="card"> <a href="/snip3-crypter-dcrat-vbs/"><div class="card-body"> <em class="timeago small" data-ts="1650067200" > 2022-04-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Snip3 Crypter used with DCRat via VBScript</h3><div class="text-muted small"><p> Adversaries love using free or cheap RATs or stealers, and I see a lot of RATs such as AsyncRAT during my daily malware analysis tasks. In this detection I want to examine a fairly recent sample fr...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/analyzing-icedid-document/" class="btn btn-outline-primary" prompt="Older"><p>Analyzing an IcedID Loader Document</p></a> <a href="/a-tale-of-two-dropper-scripts/" class="btn btn-outline-primary" prompt="Newer"><p>A Tale of Two Dropper Scripts for Agent Tesla</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/msi/">msi</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag" href="/tags/mshta/">mshta</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/cobalt-strike/">cobalt-strike</a> <a class="post-tag" href="/tags/csharp/">csharp</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-THRVSJGH6S"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-THRVSJGH6S'); }); </script>
